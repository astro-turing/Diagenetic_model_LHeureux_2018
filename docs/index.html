<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Johan Hidding" />
  <title>L’Heureux Fortran model</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="theme.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">L’Heureux Fortran model</h1>
<p class="subtitle">total decomposition of a Fortran code</p>
<p class="author">Johan Hidding</p>
<!--        <div id="dark-mode-toggle">
                <p>Dark mode: <button class="dark-mode-button"
                        aria-label="Toggle dark mode"
                        onclick="toggle_dark_mode()">
                        <span></span><span></span>
                </button></p>
</div> -->
</header>
<div class="row">
        <div class="col-6 col-s-9" id="main">
<section id="main" class="level1">
<h1>Main</h1>
<p>The <code>COMMON</code> blocks in fortran create a kind of global variables. Here they’re used to store the free parameters of the model. The array <code>P(35)</code> is used to store all input parameters and are used throughout.</p>
<div class="named-code-block">
<p>«main-declare-variables»</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">REAL*8</span> pho(<span class="dv">0</span>:<span class="dv">1000</span>),cao(<span class="dv">0</span>:<span class="dv">1000</span>),coo(<span class="dv">0</span>:<span class="dv">1000</span>),ARAo(<span class="dv">0</span>:<span class="dv">1000</span>),CALo(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">REAL*8</span>  ph(<span class="dv">0</span>:<span class="dv">1000</span>),ca(<span class="dv">0</span>:<span class="dv">1000</span>),co(<span class="dv">0</span>:<span class="dv">1000</span>),ARA(<span class="dv">0</span>:<span class="dv">1000</span>),CAL(<span class="dv">0</span>:<span class="dv">1000</span>),U(<span class="dv">0</span>:<span class="dv">1000</span>),W(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">REAL*8</span>  phalf(<span class="dv">0</span>:<span class="dv">1000</span>),ARAhalf(<span class="dv">0</span>:<span class="dv">1000</span>),CALhalf(<span class="dv">0</span>:<span class="dv">1000</span>),cahalf(<span class="dv">0</span>:<span class="dv">1000</span>),cohalf(<span class="dv">0</span>:<span class="dv">1000</span>),whalf(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dt">REAL*8</span> Rca(<span class="dv">0</span>:<span class="dv">1000</span>),Rco(<span class="dv">0</span>:<span class="dv">1000</span>),RAR(<span class="dv">0</span>:<span class="dv">1000</span>),RCAL(<span class="dv">0</span>:<span class="dv">1000</span>),RARdum(<span class="dv">0</span>:<span class="dv">1000</span>),RCALdum(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">REAL*8</span> OC(<span class="dv">0</span>:<span class="dv">1000</span>),OA(<span class="dv">0</span>:<span class="dv">1000</span>),t,dt,dx,P(<span class="dv">35</span>),dca(<span class="dv">0</span>:<span class="dv">1000</span>),dco(<span class="dv">0</span>:<span class="dv">1000</span>),sigca<span class="co">(0:1000),sigco(0:1000)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="dt">REAL*8</span> Rp(<span class="dv">0</span>:<span class="dv">1000</span>),te,wap,S(<span class="dv">0</span>:<span class="dv">1000</span>),Sdum(<span class="dv">0</span>:<span class="dv">1000</span>),Udum(<span class="dv">0</span>:<span class="dv">1000</span>),sigpo(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="dt">INTEGER</span> tmax,j,outx,i,N,outt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">COMMON/general/ pho,cao,coo,ARAo,CALo,tmax,outx,outt,N</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">COMMON/par/P</span></span></code></pre></div>
</div>
<section id="parameters-p35" class="level2">
<h2>Parameters <code>P(35)</code></h2>
<div class="table">
<table>
<thead>
<tr class="header">
<th>Number</th>
<th>Symbol</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>15</td>
<td><span class="math inline">\(\Delta t\)</span></td>
<td>time step</td>
</tr>
<tr class="even">
<td>16</td>
<td><span class="math inline">\(\Delta x\)</span></td>
<td>grid resolution</td>
</tr>
</tbody>
</table>
</div>
<div class="named-code-block">
<p>«main-open-output-files»</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">OPEN(</span><span class="dv">8</span>,<span class="fu">file</span><span class="kw">=</span><span class="st">&#39;amarlt1&#39;</span><span class="fu">)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">OPEN(</span><span class="dv">9</span>,<span class="fu">FILE</span><span class="kw">=</span><span class="st">&#39;amarlt2&#39;</span><span class="fu">)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">OPEN(</span><span class="dv">10</span>,<span class="fu">FILE</span><span class="kw">=</span><span class="st">&#39;amarlt3&#39;</span><span class="fu">)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">OPEN(</span><span class="dv">11</span>,<span class="fu">FILE</span><span class="kw">=</span><span class="st">&#39;amarlt4&#39;</span><span class="fu">)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">OPEN(</span><span class="dv">12</span>,<span class="fu">FILE</span><span class="kw">=</span><span class="st">&#39;amarlx&#39;</span><span class="fu">)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">OPEN(</span><span class="dv">13</span>,<span class="fu">FILE</span><span class="kw">=</span><span class="st">&#39;marlstuff&#39;</span><span class="fu">)</span></span></code></pre></div>
</div>
<div class="named-code-block">
<p>«main-initialize»</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">call init</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dt<span class="kw">=</span>P(<span class="dv">15</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dx<span class="kw">=</span>P(<span class="dv">16</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">do</span> i<span class="kw">=</span><span class="dv">0</span>,N</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    ph(i)<span class="kw">=</span>pho(i)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    ca(i)<span class="kw">=</span>cao(i)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    co(i)<span class="kw">=</span>coo(i)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    ARA(i)<span class="kw">=</span>ARAo(i)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    CAL(i)<span class="kw">=</span>CALo(i)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end do</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>t<span class="kw">=</span><span class="fl">0.0</span></span></code></pre></div>
</div>
<div class="named-code-block">
<p>«main-call-auxf»</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">call auxf(t,n,ph,ca,co,ARA,CAL,U,S,W,OC,OA,dca,dco,sigpo,sigca,sigco,Rp,Rca,Rco,RAR,RCAL)</span></span></code></pre></div>
</div>
<div class="named-code-block">
<p>«time-integration»</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">call projectX(n,ARA,CAL,U,S,RAR,RCAL,ARAhalf,CALhalf)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">call projectY(n,ph,ca,co,W,dca,dco,sigpo,sigca,sigco,Rp,Rca,Rco,phalf,cahalf,cohalf)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">do</span> j<span class="kw">=</span><span class="dv">1</span>,tmax</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;&lt;</span><span class="bu">log</span><span class="kw">-</span>progress<span class="op">&gt;&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">call</span> auxf(t,n,phalf,cahalf,cohalf,ARAhalf,CALhalf,Udum,Sdum,Whalf,OC<span class="co">,OA,dca,dco,sigpo,sigca,sigco,Rp,Rca,Rco,RARdum,RCALdum)   </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">call</span> CRANK(t,n,ph,ca,co,Whalf,dca,dco,sigpo,sigca,sigco,Rp,Rca,Rco,phalf)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">call</span> upwind(n,ARA,CAL,U,S,RAR,RCAL)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    t<span class="kw">=</span>t<span class="kw">+</span>dt</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">call</span> auxf(t,n,ph,ca,co,ARA,CAL,U,S,W,OC,OA,dca,dco,sigpo,sigca,sigco<span class="co">,Rp,Rca,Rco,RAR,RCAL)</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;&lt;</span><span class="fu">write</span><span class="kw">-</span>output<span class="op">&gt;&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">call</span> projectX(n,ARA,CAL,U,S,RAR,RCAL,ARAhalf,CALhalf)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">call</span> projectY(n,ph,ca,co,W,dca,dco,sigpo,sigca,sigco,Rp,Rca,Rco,phalf,cahalf,cohalf)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end do</span></span></code></pre></div>
</div>
<div class="named-code-block">
<p>file:src/decomposed.f</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">!     Last change:  IL   19 Mar 2014    5:25 pm</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">!  Rythmite limestone/marl - semiimplicit diffusion on c,po and explicit advection on M with upwind scheme</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">!  Main code</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       <span class="kw">program</span> marl_PDE</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>           <span class="kw">implicit</span> <span class="kw">none</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>           <span class="op">&lt;&lt;</span>main<span class="kw">-</span>declare<span class="kw">-</span>variables<span class="op">&gt;&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>           <span class="op">&lt;&lt;</span>main<span class="kw">-</span><span class="fu">open</span><span class="kw">-</span>output<span class="kw">-</span>files<span class="op">&gt;&gt;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>           <span class="op">&lt;&lt;</span>main<span class="kw">-</span>initialize<span class="op">&gt;&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>           <span class="op">&lt;&lt;</span>main<span class="kw">-</span><span class="fu">write</span><span class="op">&gt;&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>           <span class="op">&lt;&lt;</span>main<span class="kw">-call-</span>auxf<span class="op">&gt;&gt;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>           <span class="op">&lt;&lt;</span>main<span class="kw">-</span><span class="fu">write</span><span class="kw">-</span>again<span class="op">&gt;&gt;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>           wap<span class="kw">=</span>w(<span class="dv">0</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>           wap<span class="kw">=</span>wap    </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>           <span class="op">&lt;&lt;</span>time<span class="kw">-</span>integration<span class="op">&gt;&gt;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span>        <span class="fu">format (</span>23<span class="fu">(</span>d12.5,1x<span class="fu">))</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="dv">101</span>        <span class="fu">format (</span>13x,23<span class="fu">(</span>a2,11x<span class="fu">))</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="dv">102</span>        <span class="fu">format (</span>12<span class="fu">(</span>d12.5,1x<span class="fu">))</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="dv">103</span>        <span class="fu">FORMAT(</span>13x,12<span class="fu">(</span>a2,11x<span class="fu">))</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="dv">110</span>        <span class="fu">format(</span>13x,10<span class="fu">(</span>a2,11x<span class="fu">))</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>           <span class="fu">close (</span><span class="dv">8</span><span class="fu">)</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">CLOSE(</span><span class="dv">9</span><span class="fu">)</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>           <span class="fu">CLOSE(</span><span class="dv">10</span><span class="fu">)</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>           <span class="fu">CLOSE(</span><span class="dv">11</span><span class="fu">)</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>           <span class="fu">CLOSE(</span><span class="dv">12</span><span class="fu">)</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>           <span class="fu">CLOSE(</span><span class="dv">13</span><span class="fu">)</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>           <span class="fu">write (</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;fini&#39;</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>           <span class="kw">pause</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>           <span class="kw">stop</span> <span class="st">&#39;marl&#39;</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>       <span class="kw">end program</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>           <span class="kw">subroutine</span> auxf(t,n,ph,ca,co,ARA,CAL,U,S,W,OC,OA,dca,dco,sigpo,sigca,sigco,Rp,Rca,Rco,RAR,RCAL)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co">! This routine calculates all auxiliairy functions: Peclet numbers, oversaturations, reaction rates and others</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>           <span class="kw">implicit</span> <span class="kw">none</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>               <span class="dt">real*8</span> P(<span class="dv">35</span>),ph(<span class="dv">0</span>:<span class="dv">1000</span>),ca(<span class="dv">0</span>:<span class="dv">1000</span>),co(<span class="dv">0</span>:<span class="dv">1000</span>),ARA(<span class="dv">0</span>:<span class="dv">1000</span>)<span class="co">,CAL(0:1000),U(0:1000),W(0:1000)</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real</span> <span class="kw">*</span><span class="dv">8</span> OC(<span class="dv">0</span>:<span class="dv">1000</span>),OA(<span class="dv">0</span>:<span class="dv">1000</span>),k(<span class="dv">0</span>:<span class="dv">1000</span>),dca(<span class="dv">0</span>:<span class="dv">1000</span>),dco(<span class="dv">0</span>:<span class="dv">1000</span>),sigca(<span class="dv">0</span>:<span class="dv">1000</span>),sigco(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> Rp(<span class="dv">0</span>:<span class="dv">1000</span>),betasV,S(<span class="dv">0</span>:<span class="dv">1000</span>),sigpo(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> Rca(<span class="dv">0</span>:<span class="dv">1000</span>),Rco(<span class="dv">0</span>:<span class="dv">1000</span>),RAR(<span class="dv">0</span>:<span class="dv">1000</span>),RCAL(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> Pe1,Pe2,Pe3,sc,sa,t,rhosw0,F</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real*8</span> dpdx,dx</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co">!           real*8 xpeak,xwidth,dx</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>              <span class="dt">integer</span> icem,icemf</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>          <span class="dt">integer</span> idis,idisf</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>          <span class="dt">integer</span> i,n</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>              <span class="kw">COMMON/</span>par<span class="kw">/</span>P </span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>          dx<span class="kw">=</span>P(<span class="dv">16</span>)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a> <span class="co">!         eps=P(29)</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>          t<span class="kw">=</span>t </span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>          rhosw0<span class="kw">=</span>P(<span class="dv">20</span>)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="co">!           dx=P(16)</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="co">!            xpeak=P(22)+0.5*P(14)</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co">!           xwidth=0.5*P(14)</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>            idis<span class="kw">=</span><span class="bu">NINT</span>(P(<span class="dv">22</span>)<span class="kw">/</span>P(<span class="dv">16</span>))</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>            idisf<span class="kw">=</span><span class="bu">NINT</span>((P(<span class="dv">22</span>)<span class="kw">+</span>P(<span class="dv">14</span>))<span class="kw">/</span>P(<span class="dv">16</span>))</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>            icem<span class="kw">=</span><span class="bu">NINT</span>(P(<span class="dv">30</span>)<span class="kw">/</span>P(<span class="dv">16</span>))</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>            icemf<span class="kw">=</span><span class="bu">NINT</span>(P(<span class="dv">31</span>)<span class="kw">/</span>P(<span class="dv">16</span>))</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a> <span class="co">!           idisf=idisf+1</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a> <span class="co">!           Ko=phi0**3*(1-dexp(-10.*(1-phi0)/phi0))/(1-phi0)**2</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>             betasV<span class="kw">=</span>P(<span class="dv">32</span>)         </span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="co">!    i = 0 </span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="co">!  In fact, k is actually k*(1-ph)                </span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>                    u(<span class="dv">0</span>)<span class="kw">=</span>P(<span class="dv">23</span>)</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>                    S(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>                    k(<span class="dv">0</span>)<span class="kw">=</span>ph(<span class="dv">0</span>)<span class="kw">**</span><span class="dv">3</span><span class="kw">*</span>betasV<span class="kw">/</span>(<span class="dv">1</span><span class="kw">-</span>ph(<span class="dv">0</span>))</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>                    k(<span class="dv">0</span>)<span class="kw">=</span>k(<span class="dv">0</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="fl">10.d0</span><span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ph(<span class="dv">0</span>))<span class="kw">/</span>ph(<span class="dv">0</span>)))</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>                    dpdx<span class="kw">=</span>(ph(<span class="dv">1</span>)<span class="kw">-</span>ph(<span class="dv">0</span>))<span class="kw">/</span>dx</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>                    dpdx<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>                    dpdx<span class="kw">=</span>dpdx</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>                    w(<span class="dv">0</span>)<span class="kw">=</span>u(<span class="dv">0</span>)<span class="kw">-</span>k(<span class="dv">0</span>)<span class="kw">*</span>(rhosw0<span class="kw">-</span><span class="dv">1</span>)<span class="kw">/</span>ph(<span class="dv">0</span>)</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a> <span class="co">!                   w(0)=u(0)-k(0)*(rhosw0-1)/ph(0)*(1+dpdx*P(33)/(ph(0)-P(34)))</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a> <span class="co">!                   </span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a> <span class="co">!                                    </span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>                OA(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>                 sa<span class="kw">=</span><span class="dv">1</span><span class="kw">-</span>ca(<span class="dv">0</span>)<span class="kw">*</span>co(<span class="dv">0</span>)<span class="kw">*</span>P(<span class="dv">24</span>)</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>                 sc<span class="kw">=</span>ca(<span class="dv">0</span>)<span class="kw">*</span>co(<span class="dv">0</span>)<span class="kw">-</span><span class="fl">1.</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="co">!                 F=dexp(-(xpeak)**2/(2*xwidth**2))</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>                F<span class="kw">=</span><span class="fl">1.d0</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>                <span class="kw">IF</span>( (<span class="dv">0</span><span class="op">.gt.</span>idis)<span class="op">.and.</span> (<span class="dv">0</span><span class="op">.lt.</span>idisf)) <span class="kw">then</span>                         </span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">if</span> (sa<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>                         OA(<span class="dv">0</span>)<span class="kw">=</span>F<span class="kw">*</span>sa<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">else</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>                         OA(<span class="dv">0</span>)<span class="kw">=-</span>F<span class="kw">*</span>(<span class="kw">-</span>sa)<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>                         OA(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span> </span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">endif</span>           </span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>                <span class="kw">endif</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>                <span class="kw">IF</span>( (<span class="dv">0</span><span class="op">.eq.</span>idis)<span class="op">.or.</span> (<span class="dv">0</span><span class="op">.eq.</span>idisf)) <span class="kw">then</span>                </span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">if</span> (sa<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span> </span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>                       OA(<span class="dv">0</span>)<span class="kw">=</span>sa<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">else</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>                      OA(<span class="dv">0</span>)<span class="kw">=-</span>(<span class="kw">-</span>sa)<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>                      OA(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">endif</span>      </span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>                <span class="kw">endif</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>                <span class="kw">IF</span>( (<span class="dv">0</span><span class="op">.lt.</span>idis)<span class="op">.or.</span> (<span class="dv">0</span><span class="op">.gt.</span>idisf)) <span class="kw">then</span> </span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">if</span> (sa<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span> </span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>                       OA(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.d0</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">else</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>                       OA(<span class="dv">0</span>)<span class="kw">=-</span>(<span class="kw">-</span>sa)<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>                       OA(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">endif</span>      </span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>                <span class="kw">endif</span>       </span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>              <span class="kw">if</span>((<span class="dv">0</span><span class="op">.gt.</span>icem)<span class="op">.and.</span>(<span class="dv">0</span><span class="op">.lt.</span>icemf)) <span class="kw">then</span>               </span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> (sc<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=</span>sc<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">else</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=-</span>(<span class="kw">-</span>sc)<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">end if</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>              <span class="kw">endif</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>              <span class="kw">if</span>((<span class="dv">0</span><span class="op">.eq.</span>icem)<span class="op">.or.</span>(<span class="dv">0</span><span class="op">.eq.</span>icemf)) <span class="kw">then</span>               </span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> (sc<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=</span>sc<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">else</span></span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=-</span>(<span class="kw">-</span>sc)<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">end if</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>              <span class="kw">endif</span> </span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>              <span class="kw">if</span>((<span class="dv">0</span><span class="op">.lt.</span>icem)<span class="op">.or.</span>(<span class="dv">0</span><span class="op">.gt.</span>icemf)) <span class="kw">then</span>               </span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> (sc<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.d0</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">else</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=-</span>(<span class="kw">-</span>sc)<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>                           OC(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">end if</span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>              <span class="kw">endif</span>         </span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>                       dca(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">1.</span><span class="kw">/</span>(<span class="dv">1</span><span class="kw">-</span><span class="dv">2</span><span class="kw">*</span><span class="bu">dlog</span>(ph(<span class="dv">0</span>)))</span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>                       dco(<span class="dv">0</span>)<span class="kw">=</span>dca(<span class="dv">0</span>)<span class="kw">*</span>P(<span class="dv">25</span>)</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>           Rca(<span class="dv">0</span>)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(P(<span class="dv">6</span>)<span class="kw">/</span>P(<span class="dv">7</span>)<span class="kw">-</span>ca(<span class="dv">0</span>))<span class="kw">*</span>(OA(<span class="dv">0</span>)<span class="kw">*</span>ARA(<span class="dv">0</span>)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>OC(<span class="dv">0</span>)<span class="kw">*</span>CAL(<span class="dv">0</span><span class="co">))*(1-ph(0))/ph(0) </span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>           Rco(<span class="dv">0</span>)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(P(<span class="dv">6</span>)<span class="kw">/</span>P(<span class="dv">7</span>)<span class="kw">-</span>co(<span class="dv">0</span>))<span class="kw">*</span>(OA(<span class="dv">0</span>)<span class="kw">*</span>ARA(<span class="dv">0</span>)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>OC(<span class="dv">0</span>)<span class="kw">*</span>CAL(<span class="dv">0</span><span class="co">))*(1-ph(0))/ph(0) </span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>                      Pe1<span class="kw">=</span>w(<span class="dv">0</span>)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dca(<span class="dv">0</span>))</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>                      Pe2<span class="kw">=</span>w(<span class="dv">0</span>)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dco(<span class="dv">0</span>))</span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>                      Pe3<span class="kw">=</span>w(<span class="dv">0</span>)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>P(<span class="dv">35</span>))</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">if</span>(Pe1<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>                         sigca(<span class="dv">0</span>)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe1</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>                         sigca(<span class="dv">0</span>)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe1 </span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span>      </span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">if</span>(Pe2<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>                         sigco(<span class="dv">0</span>)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe2</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>                         sigco(<span class="dv">0</span>)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe2 </span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span>    </span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">if</span>(Pe3<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>                         sigpo(<span class="dv">0</span>)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe3</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>                         sigpo(<span class="dv">0</span>)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe3 </span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span>            </span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a> <span class="co">!  other reaction rates</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span> (<span class="dv">1</span><span class="kw">-</span>ARA(<span class="dv">0</span>)<span class="kw">-</span>CAL(<span class="dv">0</span>)<span class="op">.lt.</span><span class="fl">1.d-70</span>)<span class="kw">then</span></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>               RAR(<span class="dv">0</span>)<span class="kw">=-</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(<span class="dv">0</span>))<span class="kw">-</span>P(<span class="dv">26</span>)<span class="kw">*</span>OA(<span class="dv">0</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(<span class="dv">0</span>))<span class="kw">*</span>CAL(<span class="co">0)-P(26)*P(3)*OC(0)*(1-CAL(0))*CAL(0)</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>               RCAL(<span class="dv">0</span>)<span class="kw">=</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(<span class="dv">0</span>))<span class="kw">+</span>P(<span class="dv">3</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>OC(<span class="dv">0</span>)<span class="kw">*</span>CAL(<span class="dv">0</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span><span class="co">CAL(0))+P(26)*OA(0)*CAL(0)*(1-CAL(0))</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>               Rp(<span class="dv">0</span>)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>((<span class="dv">1</span><span class="kw">-</span>CAL(<span class="dv">0</span>))<span class="kw">*</span>OA(<span class="dv">0</span>)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>CAL(<span class="dv">0</span>)<span class="kw">*</span>OC(<span class="dv">0</span>))<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ph(<span class="dv">0</span>)<span class="co">)</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>             <span class="kw">else</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>               RAR(<span class="dv">0</span>)<span class="kw">=-</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>ARA(<span class="dv">0</span>)<span class="kw">-</span>P(<span class="dv">26</span>)<span class="kw">*</span>OA(<span class="dv">0</span>)<span class="kw">*</span>ARA(<span class="dv">0</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ARA(<span class="dv">0</span>))<span class="kw">-</span>P<span class="co">(26)*P(3)*OC(0)*ARA(0)*CAL(0)</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>               RCAL(<span class="dv">0</span>)<span class="kw">=</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>ARA(<span class="dv">0</span>)<span class="kw">+</span>P(<span class="dv">3</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>OC(<span class="dv">0</span>)<span class="kw">*</span>CAL(<span class="dv">0</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(<span class="co">0))+P(26)*OA(0)*CAL(0)*ARA(0)</span></span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>               Rp(<span class="dv">0</span>)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(ARA(<span class="dv">0</span>)<span class="kw">*</span>OA(<span class="dv">0</span>)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>CAL(<span class="dv">0</span>)<span class="kw">*</span>OC(<span class="dv">0</span>))<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ph(<span class="dv">0</span>))</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>            <span class="kw">endif</span>                       </span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a> <span class="co">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!                         </span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>             <span class="kw">do</span> <span class="dv">82</span> i<span class="kw">=</span><span class="dv">1</span>,N</span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a><span class="co">!  supersaturations</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a><span class="co">!                F=dexp(-(i*dx-xpeak)**2/(2*xwidth**2))</span></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span>(i<span class="op">.lt.</span>N) <span class="kw">then</span></span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>                  dpdx<span class="kw">=</span>(ph(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">-</span>ph(i<span class="kw">-</span><span class="dv">1</span>))<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dx)</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>                <span class="kw">else</span></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>                  dpdx<span class="kw">=</span>(ph(N)<span class="kw">-</span>ph(N<span class="kw">-</span><span class="dv">1</span>))<span class="kw">/</span>dx</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>                <span class="kw">endif</span>    </span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>                  dpdx<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>                F<span class="kw">=</span><span class="fl">1.0d0</span></span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>                OA(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>                sa<span class="kw">=</span><span class="dv">1</span><span class="kw">-</span>ca(i)<span class="kw">*</span>co(i)<span class="kw">*</span>P(<span class="dv">24</span>)</span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>                 sc<span class="kw">=</span>ca(i)<span class="kw">*</span>co(i)<span class="kw">-</span><span class="dv">1</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">IF</span>( (i<span class="op">.gt.</span>idis)<span class="op">.and.</span> (i<span class="op">.lt.</span>idisf)) <span class="kw">then</span>        </span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">if</span> (sa<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>                         OA(i)<span class="kw">=</span>F<span class="kw">*</span>sa<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">else</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>                         OA(i)<span class="kw">=-</span>F<span class="kw">*</span>(<span class="kw">-</span>sa)<span class="kw">**</span>P(<span class="dv">1</span>) </span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>                         OA(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">endif</span>           </span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">endif</span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>                <span class="kw">IF</span>( (i<span class="op">.eq.</span>idis)<span class="op">.or.</span> (i<span class="op">.eq.</span>idisf)) <span class="kw">then</span></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">if</span> (sa<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span> </span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>                       OA(i)<span class="kw">=</span>sa<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">else</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>                      OA(i)<span class="kw">=-</span>(<span class="kw">-</span>sa)<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>                      OA(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">endif</span>      </span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>                <span class="kw">endif</span></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>                <span class="kw">IF</span>( (i<span class="op">.lt.</span>idis)<span class="op">.or.</span> (i<span class="op">.gt.</span>idisf)) <span class="kw">then</span> </span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>                   <span class="kw">if</span> (sa<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span> </span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>                       OA(i)<span class="kw">=</span><span class="fl">0.d0</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">else</span></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>                      OA(i)<span class="kw">=-</span>(<span class="kw">-</span>sa)<span class="kw">**</span>P(<span class="dv">1</span>)</span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>                       OA(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">endif</span>      </span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>               <span class="kw">endif</span>       </span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>              <span class="kw">if</span>((i<span class="op">.gt.</span>icem)<span class="op">.and.</span>(i<span class="op">.lt.</span>icemf)) <span class="kw">then</span>               </span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> (sc<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=</span>sc<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">else</span></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=-</span>(<span class="kw">-</span>sc)<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">end if</span></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>              <span class="kw">endif</span></span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>              <span class="kw">if</span>((i<span class="op">.eq.</span>icem)<span class="op">.or.</span>(i<span class="op">.eq.</span>icemf)) <span class="kw">then</span>               </span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> (sc<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=</span>sc<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">else</span></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=-</span>(<span class="kw">-</span>sc)<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">end if</span></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>              <span class="kw">endif</span> </span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a>              <span class="kw">if</span>((i<span class="op">.lt.</span>icem)<span class="op">.or.</span>(i<span class="op">.gt.</span>icemf)) <span class="kw">then</span>               </span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> (sc<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=</span><span class="fl">0.d0</span></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">else</span></span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=-</span>(<span class="kw">-</span>sc)<span class="kw">**</span>P(<span class="dv">2</span>)</span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a>                           OC(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">end if</span></span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a>              <span class="kw">endif</span>        </span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a><span class="co">! velocity</span></span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a>          <span class="kw">if</span> ((<span class="dv">1</span><span class="kw">-</span>ph(i))<span class="op">.le.</span><span class="fl">0.05</span>)  <span class="kw">then</span></span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a><span class="co">!          write(6,*) &#39;p&gt;0.95 for t,i&#39;,t,i                 </span></span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a> <span class="co">! k *(1-p) actually                          </span></span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a>                           k(i)<span class="kw">=</span>betasV<span class="kw">*</span><span class="fl">10.</span><span class="kw">*</span>ph(i)<span class="kw">**</span><span class="dv">2</span></span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a>                           u(i)<span class="kw">=</span>k(i)<span class="kw">*</span>(rhosw0<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>P(<span class="dv">23</span>)<span class="kw">-</span>P(<span class="dv">13</span>)<span class="kw">*</span>k(<span class="dv">0</span>)</span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a> <span class="co">!  approx u(i)=S                          </span></span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a> <span class="co">!                          u(i)=P(23)</span></span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a>                           w(i)<span class="kw">=</span>u(i)<span class="kw">-</span>k(i)<span class="kw">*</span>(rhosw0<span class="kw">-</span><span class="dv">1</span>)<span class="kw">/</span>ph(i)</span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a> <span class="co">!                          w(i)=u(i)-k(i)*(rhosw0-1)/ph(i)*(1+dpdx*P(33)/(ph(i)-P(34)))</span></span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a> <span class="co">!</span></span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a>  <span class="co">!                        </span></span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a> <span class="co">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!                          </span></span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a>                          </span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a>                           dca(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">/</span>(<span class="dv">1</span><span class="kw">-</span><span class="dv">2</span><span class="kw">*</span><span class="bu">dlog</span>(ph(i)))</span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a>                           dco(i)<span class="kw">=</span>dca(i)<span class="kw">*</span>P(<span class="dv">25</span>)</span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a>           Rca(i)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(P(<span class="dv">6</span>)<span class="kw">/</span>P(<span class="dv">7</span>)<span class="kw">-</span>ca(i))<span class="kw">*</span>(OA(i)<span class="kw">*</span>ARA(i)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>OC(i)<span class="kw">*</span>CAL(i<span class="co">))*(1-ph(i))/ph(i) </span></span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a>           Rco(i)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(P(<span class="dv">6</span>)<span class="kw">/</span>P(<span class="dv">7</span>)<span class="kw">-</span>co(i))<span class="kw">*</span>(OA(i)<span class="kw">*</span>ARA(i)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>OC(i)<span class="kw">*</span>CAL(i<span class="co">))*(1-ph(i))/ph(i) </span></span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a>                             </span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a>                      Pe1<span class="kw">=</span>w(i)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dca(i))</span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a>                      Pe2<span class="kw">=</span>w(i)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dco(i))</span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a>                      Pe3<span class="kw">=</span>w(i)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>P(<span class="dv">35</span>))</span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">if</span>(Pe1<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a>                         sigca(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe1</span></span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a>                         sigca(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe1 </span></span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span>      </span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">if</span>(Pe2<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a>                         sigco(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe2</span></span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a>                         sigco(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe2 </span></span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span> </span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">If</span> (Pe3<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a>                         sigpo(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe3</span></span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a>                         sigpo(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe3 </span></span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span>            </span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a>          <span class="kw">else</span></span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a>                     <span class="kw">if</span> (ph(i)<span class="op">.le.</span>P(<span class="dv">34</span>)) <span class="kw">THEN</span></span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a> <span class="co">!                write(6,*) &#39;phi = eps at i, t=&#39;,ph(i),i,t</span></span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a> <span class="co">!                pause</span></span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a>                       k(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a>                       dca(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a>                       dco(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a>                       Rca(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a>                       Rco(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a>                       u(i)<span class="kw">=</span>k(i)<span class="kw">*</span>(rhosw0<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>P(<span class="dv">23</span>)<span class="kw">-</span>P(<span class="dv">13</span>)<span class="kw">*</span>k(<span class="dv">0</span>)</span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a> <span class="co">! approx  u(i)=S       </span></span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a>  <span class="co">!                     u(i)=P(23)             </span></span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a>                       w(i)<span class="kw">=</span>u(i)</span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a> <span class="co">!!!!!!!!!!!!!!!!!!                      </span></span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a>                       <span class="kw">if</span>(w(i)<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a>                          sigca(i)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a>                          sigco(i)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a>                       <span class="kw">else</span>  </span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a>                          sigca(i)<span class="kw">=-</span><span class="fl">1.</span></span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a>                          sigco(i)<span class="kw">=-</span><span class="fl">1.</span></span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a>                       <span class="kw">endif</span></span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a>                       <span class="kw">if</span>(w(i)<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a>                          sigpo(i)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a>                       <span class="kw">else</span>  </span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a>                          sigpo(i)<span class="kw">=-</span><span class="fl">1.</span></span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a>                       <span class="kw">endif</span></span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">else</span></span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a>                       k(i)<span class="kw">=</span>betasV<span class="kw">*</span>ph(i)<span class="kw">**</span><span class="dv">3</span><span class="kw">/</span>(<span class="dv">1</span><span class="kw">-</span>ph(i))</span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a>                       k(i)<span class="kw">=</span>k(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="fl">10.</span><span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ph(i))<span class="kw">/</span>ph(i)))</span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a> <span class="co">! diffusion coefficient</span></span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a>                       dca(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">/</span>(<span class="dv">1</span><span class="kw">-</span><span class="dv">2</span><span class="kw">*</span><span class="bu">dlog</span>(ph(i)))</span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a>                       dco(i)<span class="kw">=</span>dca(i)<span class="kw">*</span>P(<span class="dv">25</span>)</span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a> <span class="co">! reaction rates </span></span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a>           Rca(i)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(P(<span class="dv">6</span>)<span class="kw">/</span>P(<span class="dv">7</span>)<span class="kw">-</span>ca(i))<span class="kw">*</span>(OA(i)<span class="kw">*</span>ARA(i)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>OC(i)<span class="kw">*</span>CAL(i<span class="co">))*(1-ph(i))/ph(i) </span></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a>           Rco(i)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(P(<span class="dv">6</span>)<span class="kw">/</span>P(<span class="dv">7</span>)<span class="kw">-</span>co(i))<span class="kw">*</span>(OA(i)<span class="kw">*</span>ARA(i)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>OC(i)<span class="kw">*</span>CAL(i<span class="co">))*(1-ph(i))/ph(i) </span></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a> <span class="co">!          write(13,*)i,Rca(i),Rco(i)</span></span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a><span class="co">!  velocity u,w</span></span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a>                              u(i)<span class="kw">=</span>k(i)<span class="kw">*</span>(rhosw0<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>P(<span class="dv">23</span>)<span class="kw">-</span>P(<span class="dv">13</span>)<span class="kw">*</span>k(<span class="dv">0</span>)</span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a>                      w(i)<span class="kw">=</span>u(i)<span class="kw">-</span>k(i)<span class="kw">*</span>(rhosw0<span class="kw">-</span><span class="dv">1</span>)<span class="kw">/</span>ph(i)</span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a><span class="co">!  approx  u(i)=S               </span></span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a> <span class="co">!                     u(i)=P(23)     </span></span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a>                      w(i)<span class="kw">=</span>P(<span class="dv">23</span>)<span class="kw">-</span>k(i)<span class="kw">*</span>(rhosw0<span class="kw">-</span><span class="dv">1</span>)<span class="kw">/</span>ph(i)</span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a><span class="co">!                       w(i)=u(i)-k(i)*(rhosw0-1)/ph(i)*(1+dpdx*P(33)/(ph(i)-P(34)))</span></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a>  <span class="co">!                    </span></span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a> <span class="co">!!!!!!!!!!!!!!!!!!!!                     </span></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a>                      Pe1<span class="kw">=</span>w(i)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dca(i))</span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a>                      Pe2<span class="kw">=</span>w(i)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dco(i))</span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a>                      Pe3<span class="kw">=</span>w(i)<span class="kw">*</span>P(<span class="dv">16</span>)<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>P(<span class="dv">35</span>))</span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">if</span>(Pe1<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a>                         sigca(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe1</span></span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a>                         sigca(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe1))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe1 </span></span>
<span id="cb6-334"><a href="#cb6-334" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span>      </span>
<span id="cb6-335"><a href="#cb6-335" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">if</span>(Pe2<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a>                         sigco(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe2</span></span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a>                         sigco(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe2))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe2 </span></span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span> </span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a>                       <span class="kw">if</span>(Pe3<span class="op">.gt.</span><span class="fl">0.</span>) <span class="kw">then</span></span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a>                         sigpo(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">/</span>(<span class="fl">1.</span><span class="kw">-</span><span class="bu">dexp</span>(<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">-</span><span class="fl">1.</span><span class="co">/Pe3</span></span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">else</span></span>
<span id="cb6-343"><a href="#cb6-343" aria-hidden="true" tabindex="-1"></a>                         sigpo(i)<span class="kw">=</span>(<span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">/</span>(<span class="kw">-</span><span class="fl">1.</span><span class="kw">+</span><span class="bu">dexp</span>(<span class="dv">2</span><span class="kw">*</span>Pe3))<span class="kw">-</span><span class="fl">1.</span><span class="kw">/</span><span class="co">Pe3 </span></span>
<span id="cb6-344"><a href="#cb6-344" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">endif</span>               </span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-346"><a href="#cb6-346" aria-hidden="true" tabindex="-1"></a>              <span class="kw">endif</span>          </span>
<span id="cb6-347"><a href="#cb6-347" aria-hidden="true" tabindex="-1"></a>            <span class="kw">endif</span></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a> <span class="co">!  other reaction rates</span></span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span> (<span class="dv">1</span><span class="kw">-</span>ARA(i)<span class="kw">-</span>CAL(i)<span class="op">.lt.</span><span class="fl">1.d-70</span>)<span class="kw">then</span></span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a>               RAR(i)<span class="kw">=-</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(i))<span class="kw">-</span>P(<span class="dv">26</span>)<span class="kw">*</span>OA(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(i))<span class="kw">*</span>CAL(<span class="co">i)-P(26)*P(3)*OC(i)*(1-CAL(i))*CAL(i)</span></span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a>               RCAL(i)<span class="kw">=</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(i))<span class="kw">+</span>P(<span class="dv">3</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>OC(i)<span class="kw">*</span>CAL(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span><span class="co">CAL(i))+P(26)*OA(i)*CAL(i)*(1-CAL(i))</span></span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a>               Rp(i)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>((<span class="dv">1</span><span class="kw">-</span>CAL(i))<span class="kw">*</span>OA(i)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>CAL(i)<span class="kw">*</span>OC(i))<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ph(i)<span class="co">)</span></span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a>             <span class="kw">else</span></span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a>               RAR(i)<span class="kw">=-</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>ARA(i)<span class="kw">-</span>P(<span class="dv">26</span>)<span class="kw">*</span>OA(i)<span class="kw">*</span>ARA(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ARA(i))<span class="kw">-</span>P<span class="co">(26)*P(3)*OC(i)*ARA(i)*CAL(i)</span></span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a>               RCAL(i)<span class="kw">=</span>P(<span class="dv">4</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>ARA(i)<span class="kw">+</span>P(<span class="dv">3</span>)<span class="kw">*</span>P(<span class="dv">26</span>)<span class="kw">*</span>OC(i)<span class="kw">*</span>CAL(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>CAL(<span class="co">i))+P(26)*OA(i)*CAL(i)*ARA(i)</span></span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a>               Rp(i)<span class="kw">=</span>P(<span class="dv">26</span>)<span class="kw">*</span>(ARA(i)<span class="kw">*</span>OA(i)<span class="kw">-</span>P(<span class="dv">3</span>)<span class="kw">*</span>CAL(i)<span class="kw">*</span>OC(i))<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>ph(i))</span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a>            <span class="kw">endif</span> </span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a><span class="co">! debug          </span></span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a><span class="co">!            u(i)=P(23)</span></span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a>            S(i)<span class="kw">=</span>u(i)<span class="kw">/</span><span class="bu">dabs</span>(u(i))                        </span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a><span class="dv">82</span>         <span class="kw">continue</span></span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a><span class="co">!           write (13,111) t,ph(N/4),k(N/4),u(N/4),w(N/4)</span></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a><span class="co">!111        format (5(d12.5,1x))</span></span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a>           <span class="kw">return</span></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a>           <span class="kw">end</span></span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a>           <span class="kw">subroutine</span> projectX(n,ARA,CAL,U,S,RAR,RCAL,ARAhalf,CALhalf)</span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a><span class="co">! This routine calculates the projected solid phase fields at half-time in order to treat the non-linearities</span></span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real*8</span> U(<span class="dv">0</span>:<span class="dv">1000</span>),ARA(<span class="dv">0</span>:<span class="dv">1000</span>),CAL(<span class="dv">0</span>:<span class="dv">1000</span>),ARAhalf(<span class="dv">0</span>:<span class="dv">1000</span>),CALhalf(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> S(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> dt,dx,P(<span class="dv">35</span>),a</span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> RAR(<span class="dv">0</span>:<span class="dv">1000</span>),RCAL(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a>               <span class="dt">integer</span> N,i</span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a>           <span class="kw">COMMON/</span>par<span class="kw">/</span>P</span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a>           dx<span class="kw">=</span>P(<span class="dv">16</span>)</span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a>           dt<span class="kw">=</span>P(<span class="dv">15</span>)</span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a>           a<span class="kw">=</span>dt<span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>dx)</span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a>             ARAhalf(<span class="dv">0</span>)<span class="kw">=</span>ARA(<span class="dv">0</span>)</span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a>             CALhalf(<span class="dv">0</span>)<span class="kw">=</span>CAL(<span class="dv">0</span>)</span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a>           <span class="kw">do</span> <span class="dv">30</span> i<span class="kw">=</span><span class="dv">1</span>,n<span class="kw">-</span><span class="dv">1</span></span>
<span id="cb6-394"><a href="#cb6-394" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-395"><a href="#cb6-395" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a>             ARAhalf(i)<span class="kw">=</span>ARA(i)<span class="kw">-</span>a<span class="kw">*</span>u(i)<span class="kw">*</span>(ARA(i)<span class="kw">*</span>S(i)<span class="kw">-</span>ARA(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span><span class="fl">0.5</span><span class="kw">*</span>(S(i)<span class="kw">+</span><span class="fl">1.</span><span class="co">)+ARA(i+1)*0.5*(1.-S(i)))&amp;</span></span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>              <span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>RAR(i)</span>
<span id="cb6-398"><a href="#cb6-398" aria-hidden="true" tabindex="-1"></a>             CALhalf(i)<span class="kw">=</span>CAL(i)<span class="kw">-</span>a<span class="kw">*</span>u(i)<span class="kw">*</span>(CAL(i)<span class="kw">*</span>S(i)<span class="kw">-</span>CAL(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span><span class="fl">0.5</span><span class="kw">*</span>(S(i)<span class="kw">+</span><span class="fl">1.</span><span class="co">)+CAL(i+1)*0.5*(1.-S(i)))&amp;</span></span>
<span id="cb6-399"><a href="#cb6-399" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>               <span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>RCAL(i)</span>
<span id="cb6-400"><a href="#cb6-400" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAhalf(i)<span class="kw">-</span>CALhalf(i)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAhalf(i)<span class="kw">=</span><span class="dv">1</span><span class="kw">-</span>CALhalf(<span class="co">i)</span></span>
<span id="cb6-401"><a href="#cb6-401" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>CALhalf(i)<span class="op">.lt.</span><span class="fl">1.d-10</span>) CALhalf(i)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAhalf(i)<span class="op">.lt.</span><span class="fl">1.d-10</span>) ARAhalf(i)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(ARAhalf(i)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAhalf(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(CALhalf(i)<span class="op">.lt.</span><span class="fl">1.d-70</span>) CALhalf(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span>         <span class="kw">continue</span></span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a>             ARAhalf(n)<span class="kw">=</span>ARA(n)<span class="kw">-</span>a<span class="kw">*</span>u(n)<span class="kw">*</span>S(n)<span class="kw">*</span>(ARA(n)<span class="kw">-</span>ARA(n<span class="kw">-</span><span class="dv">1</span>))<span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>RAR(<span class="co">n)</span></span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a>             CALhalf(n)<span class="kw">=</span>CAL(n)<span class="kw">-</span>a<span class="kw">*</span>u(n)<span class="kw">*</span>S(n)<span class="kw">*</span>(CAL(n)<span class="kw">-</span>CAL(n<span class="kw">-</span><span class="dv">1</span>))<span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>RCAL<span class="co">(n)</span></span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-411"><a href="#cb6-411" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAhalf(n)<span class="kw">-</span>CALhalf(n)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAhalf(n)<span class="kw">=</span><span class="dv">1</span><span class="kw">-</span>CALhalf(<span class="co">n)</span></span>
<span id="cb6-412"><a href="#cb6-412" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>CALhalf(n)<span class="op">.lt.</span><span class="fl">1.d-10</span>) CALhalf(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-413"><a href="#cb6-413" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAhalf(n)<span class="op">.lt.</span><span class="fl">1.d-10</span>) ARAhalf(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-414"><a href="#cb6-414" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(ARAhalf(n)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAhalf(n)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-415"><a href="#cb6-415" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(CALhalf(n)<span class="op">.lt.</span><span class="fl">1.d-70</span>) CALhalf(n)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-416"><a href="#cb6-416" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-417"><a href="#cb6-417" aria-hidden="true" tabindex="-1"></a>           <span class="kw">return</span></span>
<span id="cb6-418"><a href="#cb6-418" aria-hidden="true" tabindex="-1"></a>           <span class="kw">end</span></span>
<span id="cb6-419"><a href="#cb6-419" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-420"><a href="#cb6-420" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-421"><a href="#cb6-421" aria-hidden="true" tabindex="-1"></a>           <span class="kw">SUBROUTINE</span>  projectY(n,ph,ca,co,W,dca,dco,sigpo,sigca,sigco,Rp,Rca,Rco,phalf,cahalf,cohalf)</span>
<span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a><span class="co">! This routine calculates the projected aqueous phase fields at half-time in order to treat the non-linearities</span></span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real*8</span> ph(<span class="dv">0</span>:<span class="dv">1000</span>),W(<span class="dv">0</span>:<span class="dv">1000</span>),cahalf(<span class="dv">0</span>:<span class="dv">1000</span>),cohalf(<span class="dv">0</span>:<span class="dv">1000</span>),phalf(<span class="dv">0</span>:<span class="dv">1000</span>),sigpo(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> ca(<span class="dv">0</span>:<span class="dv">1000</span>),co(<span class="dv">0</span>:<span class="dv">1000</span>),dca(<span class="dv">0</span>:<span class="dv">1000</span>),dco(<span class="dv">0</span>:<span class="dv">1000</span>),sigca(<span class="dv">0</span>:<span class="co">1000),sigco(0:1000),Rca(0:1000),Rco(0:1000)</span></span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> dt,dx,P(<span class="dv">35</span>),a,b,eps,difpor,Rp(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a>           <span class="dt">integer</span> N,i</span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a>           <span class="kw">COMMON/</span>par<span class="kw">/</span>P</span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a>           dx<span class="kw">=</span>P(<span class="dv">16</span>)</span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a>           dt<span class="kw">=</span>P(<span class="dv">15</span>)</span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a>           eps<span class="kw">=</span>P(<span class="dv">29</span>)</span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a>           a<span class="kw">=</span>dt<span class="kw">/</span>(<span class="dv">4</span><span class="kw">*</span>dx)</span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a>           b<span class="kw">=</span>dt<span class="kw">/</span>(<span class="dv">4</span><span class="kw">*</span>dx<span class="kw">*</span>dx)</span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a>           difpor<span class="kw">=</span>P(<span class="dv">35</span>)</span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a>           cahalf(<span class="dv">0</span>)<span class="kw">=</span>ca(<span class="dv">0</span>)</span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a>           cohalf(<span class="dv">0</span>)<span class="kw">=</span>co(<span class="dv">0</span>)</span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a>           phalf(<span class="dv">0</span>)<span class="kw">=</span>ph(<span class="dv">0</span>)</span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a>           <span class="kw">do</span> <span class="dv">30</span> i<span class="kw">=</span><span class="dv">1</span>,n<span class="kw">-</span><span class="dv">1</span></span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a>             phalf(i)<span class="kw">=</span>ph(i)<span class="kw">-</span>a<span class="kw">*</span>((<span class="dv">1</span><span class="kw">-</span>sigpo(i<span class="kw">+</span><span class="dv">1</span>))<span class="kw">*</span>ph(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>w(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>sigpo(i)<span class="kw">*</span><span class="co">ph(i)*w(i)-&amp;</span></span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>          (<span class="dv">1</span><span class="kw">+</span>sigpo(i<span class="kw">-</span><span class="dv">1</span>))<span class="kw">*</span>ph(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>w(i<span class="kw">-</span><span class="dv">1</span>))<span class="kw">&amp;</span></span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>b<span class="kw">*</span>difpor<span class="kw">*</span>(ph(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>ph(i)<span class="kw">+</span>ph(i<span class="kw">+</span><span class="dv">1</span>))<span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rp(i)</span>
<span id="cb6-442"><a href="#cb6-442" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(phalf(i)<span class="op">.lt.</span>eps) phalf(i)<span class="kw">=</span>eps</span>
<span id="cb6-443"><a href="#cb6-443" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>phalf(i)<span class="op">.lt.</span>eps) phalf(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">-</span>eps    </span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a><span class="co">!               </span></span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(ph(i)<span class="op">.le.</span>eps) <span class="kw">then</span></span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a>                cahalf(i)<span class="kw">=</span>ca(i)<span class="kw">-</span>a<span class="kw">*</span>w(i)<span class="kw">*</span>((<span class="dv">1</span><span class="kw">-</span>sigca(i))<span class="kw">*</span>ca(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>sigca(i)<span class="kw">*</span><span class="co">ca(i)-(1+sigca(i))*ca(i-1)) &amp;</span></span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rca(i)</span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a>                cohalf(i)<span class="kw">=</span>co(i)<span class="kw">-</span>a<span class="kw">*</span>w(i)<span class="kw">*</span>((<span class="dv">1</span><span class="kw">-</span>sigco(i))<span class="kw">*</span>co(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>sigco(i)<span class="kw">*</span><span class="co">co(i)-(1+sigco(i))*co(i-1)) &amp;</span></span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rco(i)</span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a>           <span class="kw">else</span></span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a>            cahalf(i)<span class="kw">=</span>ca(i)<span class="kw">-</span>a<span class="kw">*</span>w(i)<span class="kw">*</span>((<span class="dv">1</span><span class="kw">-</span>sigca(i))<span class="kw">*</span>ca(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>sigca(i)<span class="kw">*</span>ca(i<span class="co">)-(1+sigca(i))*ca(i-1)) &amp;</span></span>
<span id="cb6-452"><a href="#cb6-452" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span>b<span class="kw">*</span>(ph(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>dca(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span>ph(i)<span class="kw">*</span>dca(i))<span class="kw">*</span>(ca(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">-</span>ca(i))<span class="kw">/</span>ph(i) <span class="kw">&amp;</span></span>
<span id="cb6-453"><a href="#cb6-453" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">-</span>b<span class="kw">*</span>(ph(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>dca(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>ph(i)<span class="kw">*</span>dca(i))<span class="kw">*</span>(ca(i)<span class="kw">-</span>ca(i<span class="kw">-</span><span class="dv">1</span>))<span class="kw">/</span>ph(i)<span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rca(i)</span>
<span id="cb6-454"><a href="#cb6-454" aria-hidden="true" tabindex="-1"></a>            cohalf(i)<span class="kw">=</span>co(i)<span class="kw">-</span>a<span class="kw">*</span>w(i)<span class="kw">*</span>((<span class="dv">1</span><span class="kw">-</span>sigco(i))<span class="kw">*</span>co(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>sigco(i)<span class="kw">*</span>co(i<span class="co">)-(1+sigco(i))*co(i-1)) &amp;</span></span>
<span id="cb6-455"><a href="#cb6-455" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span>b<span class="kw">*</span>(ph(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>dco(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span>ph(i)<span class="kw">*</span>dco(i))<span class="kw">*</span>(co(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">-</span>co(i))<span class="kw">/</span>ph(i) <span class="kw">&amp;</span></span>
<span id="cb6-456"><a href="#cb6-456" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">-</span>b<span class="kw">*</span>(ph(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>dco(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>ph(i)<span class="kw">*</span>dco(i))<span class="kw">*</span>(co(i)<span class="kw">-</span>co(i<span class="kw">-</span><span class="dv">1</span>))<span class="kw">/</span>ph(i)<span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rco(i)</span>
<span id="cb6-457"><a href="#cb6-457" aria-hidden="true" tabindex="-1"></a>            <span class="kw">endif</span></span>
<span id="cb6-458"><a href="#cb6-458" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(cahalf(i)<span class="op">.lt.</span><span class="fl">1.d-15</span>) cahalf(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-459"><a href="#cb6-459" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(cohalf(i)<span class="op">.lt.</span><span class="fl">1.d-15</span>) cohalf(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-460"><a href="#cb6-460" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-461"><a href="#cb6-461" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-462"><a href="#cb6-462" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span>         <span class="kw">continue</span></span>
<span id="cb6-463"><a href="#cb6-463" aria-hidden="true" tabindex="-1"></a>              phalf(n)<span class="kw">=</span>ph(n)<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>(sigpo(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>ph(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>w(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">-</span>sigpo(n)<span class="kw">*</span>ph(<span class="co">n)*w(n)) &amp;</span></span>
<span id="cb6-464"><a href="#cb6-464" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span><span class="dv">4</span><span class="kw">*</span>b<span class="kw">*</span>difpor<span class="kw">*</span>(ph(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">-</span>ph(n))<span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rp(n)</span>
<span id="cb6-465"><a href="#cb6-465" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(phalf(n)<span class="op">.lt.</span>eps) phalf(n)<span class="kw">=</span>eps</span>
<span id="cb6-466"><a href="#cb6-466" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>phalf(n)<span class="op">.lt.</span>eps) phalf(n)<span class="kw">=</span><span class="fl">1.</span><span class="kw">-</span>eps    </span>
<span id="cb6-467"><a href="#cb6-467" aria-hidden="true" tabindex="-1"></a><span class="co">!               </span></span>
<span id="cb6-468"><a href="#cb6-468" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span> (ph(n)<span class="op">.le.</span>eps) <span class="kw">then</span></span>
<span id="cb6-469"><a href="#cb6-469" aria-hidden="true" tabindex="-1"></a><span class="co">!          </span></span>
<span id="cb6-470"><a href="#cb6-470" aria-hidden="true" tabindex="-1"></a>                cahalf(n)<span class="kw">=</span>ca(n)<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>w(n)<span class="kw">*</span>sigca(n)<span class="kw">*</span>(ca(n)<span class="kw">-</span>ca(n<span class="kw">-</span><span class="dv">1</span>)) <span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rca(n)</span>
<span id="cb6-471"><a href="#cb6-471" aria-hidden="true" tabindex="-1"></a>           cohalf(n)<span class="kw">=</span>co(n)<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>w(n)<span class="kw">*</span>sigco(n)<span class="kw">*</span>(co(n)<span class="kw">-</span>co(n<span class="kw">-</span><span class="dv">1</span>)) <span class="kw">+</span><span class="fl">0.5</span><span class="kw">*</span>dt<span class="kw">*</span>Rco<span class="co">(n)</span></span>
<span id="cb6-472"><a href="#cb6-472" aria-hidden="true" tabindex="-1"></a>             <span class="kw">else</span>  </span>
<span id="cb6-473"><a href="#cb6-473" aria-hidden="true" tabindex="-1"></a>           cahalf(n)<span class="kw">=</span>ca(n)<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>w(n)<span class="kw">*</span>sigca(n)<span class="kw">*</span>(ca(n)<span class="kw">-</span>ca(n<span class="kw">-</span><span class="dv">1</span>)) <span class="kw">&amp;</span></span>
<span id="cb6-474"><a href="#cb6-474" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>b<span class="kw">*</span>(ph(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>dca(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>ph(n)<span class="kw">*</span>dca(n))<span class="kw">*</span>(ca(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">-</span>ca(n))<span class="kw">/</span>ph(n)<span class="co">+0.5*dt*Rca(n)</span></span>
<span id="cb6-475"><a href="#cb6-475" aria-hidden="true" tabindex="-1"></a>           cohalf(n)<span class="kw">=</span>co(n)<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>w(n)<span class="kw">*</span>sigco(n)<span class="kw">*</span>(co(n)<span class="kw">-</span>co(n<span class="kw">-</span><span class="dv">1</span>)) <span class="kw">&amp;</span></span>
<span id="cb6-476"><a href="#cb6-476" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>             <span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>b<span class="kw">*</span>(ph(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>dco(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>ph(n)<span class="kw">*</span>dco(n))<span class="kw">*</span>(co(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">-</span>co(n))<span class="kw">/</span>ph(n)<span class="co">+0.5*dt*Rco(n)</span></span>
<span id="cb6-477"><a href="#cb6-477" aria-hidden="true" tabindex="-1"></a>             <span class="kw">endif</span></span>
<span id="cb6-478"><a href="#cb6-478" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(cahalf(n)<span class="op">.lt.</span><span class="fl">1.d-15</span>) cahalf(n)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-479"><a href="#cb6-479" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(cohalf(n)<span class="op">.lt.</span><span class="fl">1.d-15</span>) cohalf(n)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-480"><a href="#cb6-480" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-481"><a href="#cb6-481" aria-hidden="true" tabindex="-1"></a>           <span class="kw">return</span></span>
<span id="cb6-482"><a href="#cb6-482" aria-hidden="true" tabindex="-1"></a>           <span class="kw">end</span></span>
<span id="cb6-483"><a href="#cb6-483" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-484"><a href="#cb6-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-485"><a href="#cb6-485" aria-hidden="true" tabindex="-1"></a>           <span class="kw">subroutine</span> upwind(n,ARA,CAL,U,S,RAR,RCAL)</span>
<span id="cb6-486"><a href="#cb6-486" aria-hidden="true" tabindex="-1"></a><span class="co">! Implementation of the upwind scheme for the advection equations</span></span>
<span id="cb6-487"><a href="#cb6-487" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real*8</span> U(<span class="dv">0</span>:<span class="dv">1000</span>),ARA(<span class="dv">0</span>:<span class="dv">1000</span>),CAL(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-488"><a href="#cb6-488" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> RAR(<span class="dv">0</span>:<span class="dv">1000</span>),RCAL(<span class="dv">0</span>:<span class="dv">1000</span>),ARAnew(<span class="dv">0</span>:<span class="dv">1000</span>),CALnew(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> S(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> dt,dx,P(<span class="dv">35</span>),a</span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a>               <span class="dt">integer</span> N,i</span>
<span id="cb6-493"><a href="#cb6-493" aria-hidden="true" tabindex="-1"></a>           <span class="kw">COMMON/</span>par<span class="kw">/</span>P</span>
<span id="cb6-494"><a href="#cb6-494" aria-hidden="true" tabindex="-1"></a>           dx<span class="kw">=</span>P(<span class="dv">16</span>)</span>
<span id="cb6-495"><a href="#cb6-495" aria-hidden="true" tabindex="-1"></a>           dt<span class="kw">=</span>P(<span class="dv">15</span>)</span>
<span id="cb6-496"><a href="#cb6-496" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-497"><a href="#cb6-497" aria-hidden="true" tabindex="-1"></a>           a<span class="kw">=</span>dt<span class="kw">/</span>dx</span>
<span id="cb6-498"><a href="#cb6-498" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-499"><a href="#cb6-499" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb6-500"><a href="#cb6-500" aria-hidden="true" tabindex="-1"></a>           ARAnew(<span class="dv">0</span>)<span class="kw">=</span>ARA(<span class="dv">0</span>)</span>
<span id="cb6-501"><a href="#cb6-501" aria-hidden="true" tabindex="-1"></a>           CALnew(<span class="dv">0</span>)<span class="kw">=</span>CAL(<span class="dv">0</span>)</span>
<span id="cb6-502"><a href="#cb6-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-503"><a href="#cb6-503" aria-hidden="true" tabindex="-1"></a>           <span class="kw">do</span> <span class="dv">30</span> i<span class="kw">=</span><span class="dv">1</span>,n<span class="kw">-</span><span class="dv">1</span></span>
<span id="cb6-504"><a href="#cb6-504" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-505"><a href="#cb6-505" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-506"><a href="#cb6-506" aria-hidden="true" tabindex="-1"></a>             ARANEW(i)<span class="kw">=</span>ARA(i)<span class="kw">-</span>a<span class="kw">*</span>u(i)<span class="kw">*</span>(ARA(i)<span class="kw">*</span>S(i)<span class="kw">-</span>ARA(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span><span class="fl">0.5</span><span class="kw">*</span>(S(i)<span class="kw">+</span><span class="fl">1.</span>)<span class="co">+ARA(i+1)*0.5*(1.-S(i)))&amp;</span></span>
<span id="cb6-507"><a href="#cb6-507" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>              <span class="kw">+</span>dt<span class="kw">*</span>RAR(i)</span>
<span id="cb6-508"><a href="#cb6-508" aria-hidden="true" tabindex="-1"></a>             CALNEW(i)<span class="kw">=</span>CAL(i)<span class="kw">-</span>a<span class="kw">*</span>u(i)<span class="kw">*</span>(CAL(i)<span class="kw">*</span>S(i)<span class="kw">-</span>CAL(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span><span class="fl">0.5</span><span class="kw">*</span>(S(i)<span class="kw">+</span><span class="fl">1.</span>)<span class="co">+CAL(i+1)*0.5*(1.-S(i)))&amp;</span></span>
<span id="cb6-509"><a href="#cb6-509" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>               <span class="kw">+</span>dt<span class="kw">*</span>RCAL(i)</span>
<span id="cb6-510"><a href="#cb6-510" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAnew(i)<span class="kw">-</span>CALnew(i)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAnew(i)<span class="kw">=</span><span class="dv">1</span><span class="kw">-</span>CALnew(i)</span>
<span id="cb6-511"><a href="#cb6-511" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>CALnew(i)<span class="op">.lt.</span><span class="fl">1.d-10</span>) CALnew(i)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-512"><a href="#cb6-512" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAnew(i)<span class="op">.lt.</span><span class="fl">1.d-10</span>) ARAnew(i)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-513"><a href="#cb6-513" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(ARAnew(i)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAnew(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-514"><a href="#cb6-514" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(CALnew(i)<span class="op">.lt.</span><span class="fl">1.d-70</span>) CALnew(i)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-515"><a href="#cb6-515" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb6-516"><a href="#cb6-516" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span>         <span class="kw">continue</span></span>
<span id="cb6-517"><a href="#cb6-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-518"><a href="#cb6-518" aria-hidden="true" tabindex="-1"></a>             ARAnew(n)<span class="kw">=</span>ARA(n)<span class="kw">-</span>a<span class="kw">*</span>u(n)<span class="kw">*</span>S(n)<span class="kw">*</span>(ARA(n)<span class="kw">-</span>ARA(n<span class="kw">-</span><span class="dv">1</span>))<span class="kw">+</span>dt<span class="kw">*</span>RAR(n)</span>
<span id="cb6-519"><a href="#cb6-519" aria-hidden="true" tabindex="-1"></a>             CALnew(n)<span class="kw">=</span>CAL(n)<span class="kw">-</span>a<span class="kw">*</span>u(n)<span class="kw">*</span>S(n)<span class="kw">*</span>(CAL(n)<span class="kw">-</span>CAL(n<span class="kw">-</span><span class="dv">1</span>))<span class="kw">+</span>dt<span class="kw">*</span>RCAL(n)</span>
<span id="cb6-520"><a href="#cb6-520" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-521"><a href="#cb6-521" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-522"><a href="#cb6-522" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAnew(n)<span class="kw">-</span>CALnew(n)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAnew(n)<span class="kw">=</span><span class="dv">1</span><span class="kw">-</span>CALnew(n)</span>
<span id="cb6-523"><a href="#cb6-523" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>CALnew(n)<span class="op">.lt.</span><span class="fl">1.d-10</span>) CALnew(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-524"><a href="#cb6-524" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ARAnew(n)<span class="op">.lt.</span><span class="fl">1.d-10</span>) ARAnew(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-525"><a href="#cb6-525" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(ARAnew(n)<span class="op">.lt.</span><span class="fl">1.d-70</span>) ARAnew(n)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-526"><a href="#cb6-526" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(CALnew(n)<span class="op">.lt.</span><span class="fl">1.d-70</span>) CALnew(n)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-527"><a href="#cb6-527" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-528"><a href="#cb6-528" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-529"><a href="#cb6-529" aria-hidden="true" tabindex="-1"></a><span class="co">!    update</span></span>
<span id="cb6-530"><a href="#cb6-530" aria-hidden="true" tabindex="-1"></a>             <span class="kw">do</span> <span class="dv">44</span> i<span class="kw">=</span><span class="dv">0</span>,n</span>
<span id="cb6-531"><a href="#cb6-531" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb6-532"><a href="#cb6-532" aria-hidden="true" tabindex="-1"></a>                ARA(i)<span class="kw">=</span>ARAnew(i)</span>
<span id="cb6-533"><a href="#cb6-533" aria-hidden="true" tabindex="-1"></a>                CAL(i)<span class="kw">=</span>CALnew(i)</span>
<span id="cb6-534"><a href="#cb6-534" aria-hidden="true" tabindex="-1"></a><span class="dv">44</span>           <span class="kw">continue</span>                                 </span>
<span id="cb6-535"><a href="#cb6-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-536"><a href="#cb6-536" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-537"><a href="#cb6-537" aria-hidden="true" tabindex="-1"></a>           <span class="kw">return</span></span>
<span id="cb6-538"><a href="#cb6-538" aria-hidden="true" tabindex="-1"></a>           <span class="kw">end</span></span>
<span id="cb6-539"><a href="#cb6-539" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-540"><a href="#cb6-540" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-541"><a href="#cb6-541" aria-hidden="true" tabindex="-1"></a>           <span class="kw">subroutine</span> CRANK(t,n,ph,ca,co,Whalf,dca,dco,sigpo,sigca,sigco<span class="co">,Rp,Rca,Rco,phalf)</span></span>
<span id="cb6-542"><a href="#cb6-542" aria-hidden="true" tabindex="-1"></a><span class="co">! implementation of the Crank-Nicholson scheme for the advection-diffusion equations: X(n+1)=(A^-1).B.X(n)</span></span>
<span id="cb6-543"><a href="#cb6-543" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real*8</span> ph(<span class="dv">0</span>:<span class="dv">1000</span>),ca(<span class="dv">0</span>:<span class="dv">1000</span>),co(<span class="dv">0</span>:<span class="dv">1000</span>),Whalf(<span class="dv">0</span>:<span class="dv">1000</span>),sigpo(<span class="dv">0</span><span class="co">:1000),phalf(0:1000)</span></span>
<span id="cb6-544"><a href="#cb6-544" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> dt,dx,P(<span class="dv">35</span>),sigca(<span class="dv">0</span>:<span class="dv">1000</span>),sigco(<span class="dv">0</span>:<span class="dv">1000</span>),dca(<span class="dv">0</span>:<span class="dv">1000</span>),dco(<span class="dv">0</span>:<span class="dv">1000</span>),Rca(<span class="dv">0</span>:<span class="dv">1000</span>),Rco(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-545"><a href="#cb6-545" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> aA1(<span class="dv">0</span>:<span class="dv">1000</span>),bA1(<span class="dv">0</span>:<span class="dv">1000</span>),cA1(<span class="dv">0</span>:<span class="dv">1000</span>),aA2(<span class="dv">0</span>:<span class="dv">1000</span>),bA2(<span class="dv">0</span>:<span class="co">1000),cA2(0:1000),Byca(0:1000),Byco(0:1000)</span></span>
<span id="cb6-546"><a href="#cb6-546" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> aA3(<span class="dv">0</span>:<span class="dv">1000</span>),bA3(<span class="dv">0</span>:<span class="dv">1000</span>),cA3(<span class="dv">0</span>:<span class="dv">1000</span>),Bypo(<span class="dv">0</span>:<span class="dv">1000</span>),Rp(<span class="dv">0</span>:<span class="co">1000)</span></span>
<span id="cb6-547"><a href="#cb6-547" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> a,b,t,eps</span>
<span id="cb6-548"><a href="#cb6-548" aria-hidden="true" tabindex="-1"></a>           <span class="dt">integer</span> N,i</span>
<span id="cb6-549"><a href="#cb6-549" aria-hidden="true" tabindex="-1"></a>           <span class="kw">COMMON/</span>par<span class="kw">/</span>P</span>
<span id="cb6-550"><a href="#cb6-550" aria-hidden="true" tabindex="-1"></a>           dx<span class="kw">=</span>P(<span class="dv">16</span>)</span>
<span id="cb6-551"><a href="#cb6-551" aria-hidden="true" tabindex="-1"></a>           dt<span class="kw">=</span>P(<span class="dv">15</span>)</span>
<span id="cb6-552"><a href="#cb6-552" aria-hidden="true" tabindex="-1"></a>           eps<span class="kw">=</span>P(<span class="dv">29</span>)</span>
<span id="cb6-553"><a href="#cb6-553" aria-hidden="true" tabindex="-1"></a>           a<span class="kw">=</span>dt<span class="kw">/</span>(<span class="dv">4</span><span class="kw">*</span>dx)</span>
<span id="cb6-554"><a href="#cb6-554" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-555"><a href="#cb6-555" aria-hidden="true" tabindex="-1"></a>           b<span class="kw">=</span>dt<span class="kw">/</span>(<span class="dv">4</span><span class="kw">*</span>dx<span class="kw">*</span>dx)</span>
<span id="cb6-556"><a href="#cb6-556" aria-hidden="true" tabindex="-1"></a>           <span class="kw">call</span> matA(n,a,b,phalf,whalf,sigpo,sigca,sigco,dca,dco,aA1,bA1<span class="co">,cA1,aA2,bA2,cA2,aA3,bA3,cA3)</span></span>
<span id="cb6-557"><a href="#cb6-557" aria-hidden="true" tabindex="-1"></a>           <span class="kw">call</span> matBy(n,dt,a,b,ph,ca,co,phalf,whalf,sigpo,sigca,sigco,dca,dco,Rp,Rca,Rco,Bypo,Byca,Byco)</span>
<span id="cb6-558"><a href="#cb6-558" aria-hidden="true" tabindex="-1"></a> <span class="co">!          if (t.gt.320.2) then</span></span>
<span id="cb6-559"><a href="#cb6-559" aria-hidden="true" tabindex="-1"></a> <span class="co">!             WRITE(13,*) t,aA1(25),aA1(26),bA1(25),bA1(26),cA1(25),cA1(26)</span></span>
<span id="cb6-560"><a href="#cb6-560" aria-hidden="true" tabindex="-1"></a>  <span class="co">!            WRITE(13,*) t,aA2(25),aA2(26),bA2(25),bA2(26),cA2(25),cA2(26)</span></span>
<span id="cb6-561"><a href="#cb6-561" aria-hidden="true" tabindex="-1"></a>  <span class="co">!         endif</span></span>
<span id="cb6-562"><a href="#cb6-562" aria-hidden="true" tabindex="-1"></a><span class="co">!  find solution</span></span>
<span id="cb6-563"><a href="#cb6-563" aria-hidden="true" tabindex="-1"></a>          <span class="kw">call</span> tridag(t,n,aA1,bA1,cA1,Byca,ca)</span>
<span id="cb6-564"><a href="#cb6-564" aria-hidden="true" tabindex="-1"></a>          <span class="kw">call</span> tridag(t,n,aA2,bA2,cA2,Byco,co)</span>
<span id="cb6-565"><a href="#cb6-565" aria-hidden="true" tabindex="-1"></a>      <span class="kw">call</span> tridag(t,n,aA3,bA3,cA3,Bypo,ph)</span>
<span id="cb6-566"><a href="#cb6-566" aria-hidden="true" tabindex="-1"></a>          <span class="kw">do</span> <span class="dv">30</span> i<span class="kw">=</span><span class="dv">0</span>,n</span>
<span id="cb6-567"><a href="#cb6-567" aria-hidden="true" tabindex="-1"></a>              <span class="kw">IF</span>(ca(i)<span class="op">.lt.</span><span class="fl">1.d-15</span>) ca(i) <span class="kw">=</span> <span class="fl">0.</span></span>
<span id="cb6-568"><a href="#cb6-568" aria-hidden="true" tabindex="-1"></a>              <span class="kw">IF</span>(co(i)<span class="op">.lt.</span><span class="fl">1.d-15</span>) co(i) <span class="kw">=</span> <span class="fl">0.</span></span>
<span id="cb6-569"><a href="#cb6-569" aria-hidden="true" tabindex="-1"></a>              <span class="kw">if</span>(ph(i)<span class="op">.lt.</span>eps) ph(i)<span class="kw">=</span>eps</span>
<span id="cb6-570"><a href="#cb6-570" aria-hidden="true" tabindex="-1"></a>             <span class="kw">if</span>(<span class="dv">1</span><span class="kw">-</span>ph(i)<span class="op">.lt.</span>eps) ph(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">-</span>eps    </span>
<span id="cb6-571"><a href="#cb6-571" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb6-572"><a href="#cb6-572" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span>        <span class="kw">continue</span></span>
<span id="cb6-573"><a href="#cb6-573" aria-hidden="true" tabindex="-1"></a>          <span class="kw">return</span></span>
<span id="cb6-574"><a href="#cb6-574" aria-hidden="true" tabindex="-1"></a>          <span class="kw">end</span></span>
<span id="cb6-575"><a href="#cb6-575" aria-hidden="true" tabindex="-1"></a>  <span class="co">!</span></span>
<span id="cb6-576"><a href="#cb6-576" aria-hidden="true" tabindex="-1"></a>  <span class="co">!</span></span>
<span id="cb6-577"><a href="#cb6-577" aria-hidden="true" tabindex="-1"></a>  <span class="co">!</span></span>
<span id="cb6-578"><a href="#cb6-578" aria-hidden="true" tabindex="-1"></a>          <span class="kw">subroutine</span> matA(n,a,b,phalf,whalf,sigpo,sigca,sigco,dca,dco,aA1,bA1,cA1,aA2,bA2,cA2,aA3,bA3,cA3)</span>
<span id="cb6-579"><a href="#cb6-579" aria-hidden="true" tabindex="-1"></a> <span class="co">! Determine the matrix elements of the tridiagonal matrix A in the Crank-Nicholson scheme</span></span>
<span id="cb6-580"><a href="#cb6-580" aria-hidden="true" tabindex="-1"></a>          <span class="dt">real*8</span> Whalf(<span class="dv">0</span>:<span class="dv">1000</span>),phalf(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-581"><a href="#cb6-581" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> sigpo(<span class="dv">0</span>:<span class="dv">1000</span>),sigca(<span class="dv">0</span>:<span class="dv">1000</span>),sigco(<span class="dv">0</span>:<span class="dv">1000</span>),dca(<span class="dv">0</span>:<span class="dv">1000</span>),<span class="co">dco(0:1000)</span></span>
<span id="cb6-582"><a href="#cb6-582" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> aA1(<span class="dv">0</span>:<span class="dv">1000</span>),bA1(<span class="dv">0</span>:<span class="dv">1000</span>),cA1(<span class="dv">0</span>:<span class="dv">1000</span>),aA2(<span class="dv">0</span>:<span class="dv">1000</span>),bA2(<span class="dv">0</span>:<span class="co">1000),cA2(0:1000)</span></span>
<span id="cb6-583"><a href="#cb6-583" aria-hidden="true" tabindex="-1"></a>           <span class="dt">Real*8</span> aA3(<span class="dv">0</span>:<span class="dv">1000</span>),bA3(<span class="dv">0</span>:<span class="dv">1000</span>),cA3(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-584"><a href="#cb6-584" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> a,b,eps,P(<span class="dv">35</span>),difpor</span>
<span id="cb6-585"><a href="#cb6-585" aria-hidden="true" tabindex="-1"></a>           <span class="dt">integer</span> N,i</span>
<span id="cb6-586"><a href="#cb6-586" aria-hidden="true" tabindex="-1"></a>           <span class="kw">common/</span>par<span class="kw">/</span>P</span>
<span id="cb6-587"><a href="#cb6-587" aria-hidden="true" tabindex="-1"></a>           eps<span class="kw">=</span>P(<span class="dv">29</span>)</span>
<span id="cb6-588"><a href="#cb6-588" aria-hidden="true" tabindex="-1"></a>           difpor<span class="kw">=</span>P(<span class="dv">35</span>)</span>
<span id="cb6-589"><a href="#cb6-589" aria-hidden="true" tabindex="-1"></a>           aA1(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-590"><a href="#cb6-590" aria-hidden="true" tabindex="-1"></a>           bA1(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-591"><a href="#cb6-591" aria-hidden="true" tabindex="-1"></a>           cA1(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-592"><a href="#cb6-592" aria-hidden="true" tabindex="-1"></a>           aA2(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-593"><a href="#cb6-593" aria-hidden="true" tabindex="-1"></a>           bA2(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-594"><a href="#cb6-594" aria-hidden="true" tabindex="-1"></a>           cA2(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-595"><a href="#cb6-595" aria-hidden="true" tabindex="-1"></a>           aA3(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-596"><a href="#cb6-596" aria-hidden="true" tabindex="-1"></a>           bA3(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-597"><a href="#cb6-597" aria-hidden="true" tabindex="-1"></a>           cA3(<span class="dv">0</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-598"><a href="#cb6-598" aria-hidden="true" tabindex="-1"></a>          <span class="kw">do</span> <span class="dv">10</span> i<span class="kw">=</span><span class="dv">1</span>,n<span class="kw">-</span><span class="dv">1</span></span>
<span id="cb6-599"><a href="#cb6-599" aria-hidden="true" tabindex="-1"></a>           aA3(i)<span class="kw">=-</span>a<span class="kw">*</span>whalf(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigpo(i<span class="kw">-</span><span class="dv">1</span>))<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>difpor<span class="kw">*</span>b</span>
<span id="cb6-600"><a href="#cb6-600" aria-hidden="true" tabindex="-1"></a>           bA3(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>sigpo(i)<span class="kw">+</span><span class="dv">4</span><span class="kw">*</span>difpor<span class="kw">*</span>b</span>
<span id="cb6-601"><a href="#cb6-601" aria-hidden="true" tabindex="-1"></a>           cA3(i)<span class="kw">=</span>a<span class="kw">*</span>whalf(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigpo(i<span class="kw">+</span><span class="dv">1</span>))<span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>difpor<span class="kw">*</span>b</span>
<span id="cb6-602"><a href="#cb6-602" aria-hidden="true" tabindex="-1"></a> <span class="co">!     </span></span>
<span id="cb6-603"><a href="#cb6-603" aria-hidden="true" tabindex="-1"></a>           <span class="kw">if</span> (phalf(i)<span class="op">.le.</span>eps) <span class="kw">then</span></span>
<span id="cb6-604"><a href="#cb6-604" aria-hidden="true" tabindex="-1"></a>           aA1(i)<span class="kw">=</span> <span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigca(i))</span>
<span id="cb6-605"><a href="#cb6-605" aria-hidden="true" tabindex="-1"></a>           bA1(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigca(i)</span>
<span id="cb6-606"><a href="#cb6-606" aria-hidden="true" tabindex="-1"></a>           cA1(i)<span class="kw">=</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigca(i))</span>
<span id="cb6-607"><a href="#cb6-607" aria-hidden="true" tabindex="-1"></a>           aA2(i)<span class="kw">=</span> <span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigco(i))</span>
<span id="cb6-608"><a href="#cb6-608" aria-hidden="true" tabindex="-1"></a>           bA2(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigco(i)</span>
<span id="cb6-609"><a href="#cb6-609" aria-hidden="true" tabindex="-1"></a>           cA2(i)<span class="kw">=</span> a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigco(i))</span>
<span id="cb6-610"><a href="#cb6-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-611"><a href="#cb6-611" aria-hidden="true" tabindex="-1"></a>           <span class="kw">else</span>  </span>
<span id="cb6-612"><a href="#cb6-612" aria-hidden="true" tabindex="-1"></a>               aA1(i)<span class="kw">=</span> <span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigca(i))<span class="kw">-</span>b<span class="kw">*</span>(dca(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>dca(i)<span class="kw">*</span>phalf(i))<span class="kw">/</span>phalf(i)</span>
<span id="cb6-613"><a href="#cb6-613" aria-hidden="true" tabindex="-1"></a>           bA1(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigca(i)<span class="kw">+</span>b<span class="kw">*</span>(<span class="dv">2</span><span class="kw">*</span>phalf(i)<span class="kw">*</span>dca(i)<span class="kw">+</span>phalf(i<span class="kw">+</span><span class="co">1)*dca(i+1)+phalf(i-1)*dca(i-1))/phalf(i)</span></span>
<span id="cb6-614"><a href="#cb6-614" aria-hidden="true" tabindex="-1"></a>           cA1(i)<span class="kw">=</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigca(i))<span class="kw">-</span>b<span class="kw">*</span>(dca(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span>dca(i)<span class="kw">*</span><span class="co">phalf(i))/phalf(i)</span></span>
<span id="cb6-615"><a href="#cb6-615" aria-hidden="true" tabindex="-1"></a>           aA2(i)<span class="kw">=</span> <span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigco(i))<span class="kw">-</span>b<span class="kw">*</span>(dco(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>dco(i<span class="co">)*phalf(i))/phalf(i)</span></span>
<span id="cb6-616"><a href="#cb6-616" aria-hidden="true" tabindex="-1"></a>           bA2(i)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigco(i)<span class="kw">+</span>b<span class="kw">*</span>(<span class="dv">2</span><span class="kw">*</span>phalf(i)<span class="kw">*</span>dco(i)<span class="kw">+</span>phalf(i<span class="kw">+</span><span class="co">1)*dco(i+1)+phalf(i-1)*dco(i-1))/phalf(i)</span></span>
<span id="cb6-617"><a href="#cb6-617" aria-hidden="true" tabindex="-1"></a>           cA2(i)<span class="kw">=</span> a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigco(i))<span class="kw">-</span>b<span class="kw">*</span>(dco(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span>dco(i)<span class="co">*phalf(i))/phalf(i)</span></span>
<span id="cb6-618"><a href="#cb6-618" aria-hidden="true" tabindex="-1"></a>           <span class="kw">endif</span></span>
<span id="cb6-619"><a href="#cb6-619" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>       <span class="kw">continue</span></span>
<span id="cb6-620"><a href="#cb6-620" aria-hidden="true" tabindex="-1"></a>           aA3(n)<span class="kw">=-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>sigpo(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">-</span><span class="dv">4</span><span class="kw">*</span>difpor<span class="kw">*</span>b</span>
<span id="cb6-621"><a href="#cb6-621" aria-hidden="true" tabindex="-1"></a>           bA3(n)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigpo(n)<span class="kw">+</span><span class="dv">4</span><span class="kw">*</span>difpor<span class="kw">*</span>b</span>
<span id="cb6-622"><a href="#cb6-622" aria-hidden="true" tabindex="-1"></a>           cA3(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-623"><a href="#cb6-623" aria-hidden="true" tabindex="-1"></a> <span class="co">!          </span></span>
<span id="cb6-624"><a href="#cb6-624" aria-hidden="true" tabindex="-1"></a>           <span class="kw">if</span>(phalf(n)<span class="op">.le.</span>eps) <span class="kw">then</span></span>
<span id="cb6-625"><a href="#cb6-625" aria-hidden="true" tabindex="-1"></a>           aA1(n)<span class="kw">=</span> <span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n)</span>
<span id="cb6-626"><a href="#cb6-626" aria-hidden="true" tabindex="-1"></a>           bA1(n)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n)</span>
<span id="cb6-627"><a href="#cb6-627" aria-hidden="true" tabindex="-1"></a>           cA1(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-628"><a href="#cb6-628" aria-hidden="true" tabindex="-1"></a>           aA2(n)<span class="kw">=</span> <span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n)</span>
<span id="cb6-629"><a href="#cb6-629" aria-hidden="true" tabindex="-1"></a>           bA2(n)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n)</span>
<span id="cb6-630"><a href="#cb6-630" aria-hidden="true" tabindex="-1"></a>           cA2(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-631"><a href="#cb6-631" aria-hidden="true" tabindex="-1"></a>           <span class="kw">else</span></span>
<span id="cb6-632"><a href="#cb6-632" aria-hidden="true" tabindex="-1"></a>           aA1(n)<span class="kw">=</span> <span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n)<span class="kw">-</span>b<span class="kw">*</span>(dca(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">3</span><span class="kw">*</span>dca(n<span class="co">)*phalf(n))/phalf(n)</span></span>
<span id="cb6-633"><a href="#cb6-633" aria-hidden="true" tabindex="-1"></a>           bA1(n)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n)<span class="kw">+</span>b<span class="kw">*</span>(<span class="dv">3</span><span class="kw">*</span>dca(n)<span class="kw">*</span>phalf(n)<span class="kw">+</span>phalf(n<span class="kw">-</span><span class="co">1)*dca(n-1))/phalf(n)</span></span>
<span id="cb6-634"><a href="#cb6-634" aria-hidden="true" tabindex="-1"></a>           cA1(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-635"><a href="#cb6-635" aria-hidden="true" tabindex="-1"></a>           aA2(n)<span class="kw">=</span> <span class="kw">-</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n)<span class="kw">-</span>b<span class="kw">*</span>(dco(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">3</span><span class="kw">*</span>dco(n<span class="co">)*phalf(n))/phalf(n)</span></span>
<span id="cb6-636"><a href="#cb6-636" aria-hidden="true" tabindex="-1"></a>           bA2(n)<span class="kw">=</span><span class="fl">1.</span><span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n)<span class="kw">+</span>b<span class="kw">*</span>(<span class="dv">3</span><span class="kw">*</span>dco(n)<span class="kw">*</span>phalf(n)<span class="kw">+</span>phalf(n<span class="kw">-</span><span class="co">1)*dco(n-1))/phalf(n)</span></span>
<span id="cb6-637"><a href="#cb6-637" aria-hidden="true" tabindex="-1"></a>           cA2(n)<span class="kw">=</span><span class="fl">1.</span></span>
<span id="cb6-638"><a href="#cb6-638" aria-hidden="true" tabindex="-1"></a>           <span class="kw">endif</span></span>
<span id="cb6-639"><a href="#cb6-639" aria-hidden="true" tabindex="-1"></a>          <span class="kw">return</span></span>
<span id="cb6-640"><a href="#cb6-640" aria-hidden="true" tabindex="-1"></a>          <span class="kw">end</span></span>
<span id="cb6-641"><a href="#cb6-641" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-642"><a href="#cb6-642" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-643"><a href="#cb6-643" aria-hidden="true" tabindex="-1"></a>          <span class="kw">subroutine</span> matby(n,dt,a,b,ph,ca,co,phalf,whalf,sigpo,sigca,sigco,dca,dco,Rp,Rca,Rco,Bypo,Byca,Byco)</span>
<span id="cb6-644"><a href="#cb6-644" aria-hidden="true" tabindex="-1"></a><span class="co">! Determine the matrix elements of the tridiagonal matrix B in the Crank-Nicholson scheme</span></span>
<span id="cb6-645"><a href="#cb6-645" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> phalf(<span class="dv">0</span>:<span class="dv">1000</span>),whalf(<span class="dv">0</span>:<span class="dv">1000</span>),sigpo(<span class="dv">0</span>:<span class="dv">1000</span>), sigca(<span class="dv">0</span>:<span class="dv">1000</span>),sigco(<span class="dv">0</span>:<span class="dv">1000</span>),dca(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-646"><a href="#cb6-646" aria-hidden="true" tabindex="-1"></a>       <span class="dt">REAL*8</span> dco(<span class="dv">0</span>:<span class="dv">1000</span>),Rca(<span class="dv">0</span>:<span class="dv">1000</span>),Rco(<span class="dv">0</span>:<span class="dv">1000</span>),Rp(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-647"><a href="#cb6-647" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> Byca(<span class="dv">0</span>:<span class="dv">1000</span>),Byco(<span class="dv">0</span>:<span class="dv">1000</span>),Bypo(<span class="dv">0</span>:<span class="dv">1000</span>),co(<span class="dv">0</span>:<span class="dv">1000</span>),ca(<span class="dv">0</span><span class="co">:1000),ph(0:1000)</span></span>
<span id="cb6-648"><a href="#cb6-648" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> a,b,dt,P(<span class="dv">35</span>),eps,difpor</span>
<span id="cb6-649"><a href="#cb6-649" aria-hidden="true" tabindex="-1"></a>           <span class="dt">integer</span> N,i</span>
<span id="cb6-650"><a href="#cb6-650" aria-hidden="true" tabindex="-1"></a>           <span class="kw">common/</span>par<span class="kw">/</span>P</span>
<span id="cb6-651"><a href="#cb6-651" aria-hidden="true" tabindex="-1"></a>          eps<span class="kw">=</span>P(<span class="dv">29</span>)</span>
<span id="cb6-652"><a href="#cb6-652" aria-hidden="true" tabindex="-1"></a>          difpor<span class="kw">=</span>P(<span class="dv">35</span>)</span>
<span id="cb6-653"><a href="#cb6-653" aria-hidden="true" tabindex="-1"></a>          Byca(<span class="dv">0</span>)<span class="kw">=</span>ca(<span class="dv">0</span>)</span>
<span id="cb6-654"><a href="#cb6-654" aria-hidden="true" tabindex="-1"></a>          Byco(<span class="dv">0</span>)<span class="kw">=</span>co(<span class="dv">0</span>)</span>
<span id="cb6-655"><a href="#cb6-655" aria-hidden="true" tabindex="-1"></a>          Bypo(<span class="dv">0</span>)<span class="kw">=</span>ph(<span class="dv">0</span>)</span>
<span id="cb6-656"><a href="#cb6-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-657"><a href="#cb6-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-658"><a href="#cb6-658" aria-hidden="true" tabindex="-1"></a>          <span class="kw">do</span> <span class="dv">10</span> i<span class="kw">=</span><span class="dv">1</span>,n<span class="kw">-</span><span class="dv">1</span></span>
<span id="cb6-659"><a href="#cb6-659" aria-hidden="true" tabindex="-1"></a>       Bypo(i)<span class="kw">=</span>(a<span class="kw">*</span>whalf(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigpo(i<span class="kw">-</span><span class="dv">1</span>))<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>b<span class="kw">*</span>difpor)<span class="kw">*</span>ph(i<span class="kw">-</span><span class="dv">1</span>) <span class="kw">&amp;</span></span>
<span id="cb6-660"><a href="#cb6-660" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigpo(i)<span class="kw">-</span><span class="dv">4</span><span class="kw">*</span>b<span class="kw">*</span>difpor)<span class="kw">*</span>ph(i) <span class="kw">&amp;</span></span>
<span id="cb6-661"><a href="#cb6-661" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>  (<span class="kw">-</span>a<span class="kw">*</span>whalf(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigpo(i<span class="kw">+</span><span class="dv">1</span>))<span class="kw">+</span><span class="dv">2</span><span class="kw">*</span>b<span class="kw">*</span>difpor)<span class="kw">*</span>ph(i<span class="kw">+</span><span class="dv">1</span>) <span class="kw">+</span> dt<span class="co">*Rp(i)</span></span>
<span id="cb6-662"><a href="#cb6-662" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-663"><a href="#cb6-663" aria-hidden="true" tabindex="-1"></a> <span class="co">!</span></span>
<span id="cb6-664"><a href="#cb6-664" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span>(phalf(i)<span class="op">.le.</span>eps) <span class="kw">then</span></span>
<span id="cb6-665"><a href="#cb6-665" aria-hidden="true" tabindex="-1"></a>        Byca(i)<span class="kw">=</span> (a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigca(i)))<span class="kw">*</span>ca(i<span class="kw">-</span><span class="dv">1</span>) <span class="kw">&amp;</span></span>
<span id="cb6-666"><a href="#cb6-666" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigca(i))<span class="kw">*</span>ca(i) <span class="kw">&amp;</span></span>
<span id="cb6-667"><a href="#cb6-667" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>  (<span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigca(i)))<span class="kw">*</span>ca(i<span class="kw">+</span><span class="dv">1</span>) <span class="kw">+</span> dt<span class="kw">*</span>Rca(i)</span>
<span id="cb6-668"><a href="#cb6-668" aria-hidden="true" tabindex="-1"></a>           Byco(i)<span class="kw">=</span>(a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigco(i)))<span class="kw">*</span>co(i<span class="kw">-</span><span class="dv">1</span>) <span class="kw">&amp;</span></span>
<span id="cb6-669"><a href="#cb6-669" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigco(i))<span class="kw">*</span>co(i) <span class="kw">&amp;</span></span>
<span id="cb6-670"><a href="#cb6-670" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>  (<span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigco(i)))<span class="kw">*</span>co(i<span class="kw">+</span><span class="dv">1</span>) <span class="kw">+</span> dt<span class="kw">*</span>Rco(i)</span>
<span id="cb6-671"><a href="#cb6-671" aria-hidden="true" tabindex="-1"></a>      <span class="kw">else</span> </span>
<span id="cb6-672"><a href="#cb6-672" aria-hidden="true" tabindex="-1"></a>           Byca(i)<span class="kw">=</span> (a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigca(i))<span class="kw">+</span>b<span class="kw">*</span>(dca(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>dca(<span class="co">i)*phalf(i))/phalf(i))*ca(i-1) &amp;</span></span>
<span id="cb6-673"><a href="#cb6-673" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigca(i)<span class="kw">-</span>b<span class="kw">*</span>(<span class="dv">2</span><span class="kw">*</span>dca(i)<span class="kw">*</span>phalf(i)<span class="kw">+</span>dca(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span><span class="co">phalf(i+1)+dca(i-1)*phalf(i-1))/phalf(i))*ca(i) &amp;</span></span>
<span id="cb6-674"><a href="#cb6-674" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>  (<span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigca(i))<span class="kw">+</span>b<span class="kw">*</span>(dca(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span>dca(i<span class="co">)*phalf(i))/phalf(i))*ca(i+1) + dt*Rca(i)</span></span>
<span id="cb6-675"><a href="#cb6-675" aria-hidden="true" tabindex="-1"></a>           Byco(i)<span class="kw">=</span>(a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">+</span>sigco(i))<span class="kw">+</span>b<span class="kw">*</span>(dco(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>dco(i<span class="co">)*phalf(i))/phalf(i))*co(i-1) &amp;</span></span>
<span id="cb6-676"><a href="#cb6-676" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(i)<span class="kw">*</span>sigco(i)<span class="kw">-</span>b<span class="kw">*</span>(<span class="dv">2</span><span class="kw">*</span>dco(i)<span class="kw">*</span>phalf(i)<span class="kw">+</span>dco(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span><span class="co">phalf(i+1)+dco(i-1)*phalf(i-1))/phalf(i))*co(i) &amp;</span></span>
<span id="cb6-677"><a href="#cb6-677" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>  (<span class="kw">-</span>a<span class="kw">*</span>whalf(i)<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>sigco(i))<span class="kw">+</span>b<span class="kw">*</span>(dco(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>phalf(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span>dco(i<span class="co">)*phalf(i))/phalf(i))*co(i+1) + dt*Rco(i)</span></span>
<span id="cb6-678"><a href="#cb6-678" aria-hidden="true" tabindex="-1"></a>         <span class="kw">endif</span></span>
<span id="cb6-679"><a href="#cb6-679" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>       <span class="kw">continue</span></span>
<span id="cb6-680"><a href="#cb6-680" aria-hidden="true" tabindex="-1"></a>         Bypo(n)<span class="kw">=</span>(<span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>sigpo(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">4</span><span class="kw">*</span>b<span class="kw">*</span>difpor)<span class="kw">*</span>ph(n<span class="kw">-</span><span class="dv">1</span>) <span class="kw">&amp;</span></span>
<span id="cb6-681"><a href="#cb6-681" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(n)<span class="kw">*</span>sigpo(n)<span class="kw">-</span><span class="dv">4</span><span class="kw">*</span>b<span class="kw">*</span>difpor)<span class="kw">*</span>ph(n) <span class="kw">+</span> dt<span class="kw">*</span>Rp(n)</span>
<span id="cb6-682"><a href="#cb6-682" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-683"><a href="#cb6-683" aria-hidden="true" tabindex="-1"></a>         <span class="kw">if</span>(phalf(n)<span class="op">.le.</span>eps) <span class="kw">then</span></span>
<span id="cb6-684"><a href="#cb6-684" aria-hidden="true" tabindex="-1"></a>                    Byca(n)<span class="kw">=</span> <span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n)<span class="kw">*</span>ca(n<span class="kw">-</span><span class="dv">1</span>) <span class="kw">&amp;</span></span>
<span id="cb6-685"><a href="#cb6-685" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n))<span class="kw">*</span>ca(n)<span class="kw">+</span>dt<span class="kw">*</span>Rca(n)</span>
<span id="cb6-686"><a href="#cb6-686" aria-hidden="true" tabindex="-1"></a>            Byco(n)<span class="kw">=</span><span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n)<span class="kw">*</span>co(n<span class="kw">-</span><span class="dv">1</span>) <span class="kw">&amp;</span></span>
<span id="cb6-687"><a href="#cb6-687" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n))<span class="kw">*</span>co(n)<span class="kw">+</span>dt<span class="kw">*</span>Rco(n)</span>
<span id="cb6-688"><a href="#cb6-688" aria-hidden="true" tabindex="-1"></a>         <span class="kw">else</span>            </span>
<span id="cb6-689"><a href="#cb6-689" aria-hidden="true" tabindex="-1"></a>           Byca(n)<span class="kw">=</span> (<span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n)<span class="kw">+</span>b<span class="kw">*</span>(dca(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">3</span><span class="kw">*</span>dca(<span class="co">n)*phalf(n))/phalf(n))*ca(n-1) &amp;</span></span>
<span id="cb6-690"><a href="#cb6-690" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(n)<span class="kw">*</span>sigca(n)<span class="kw">-</span>b<span class="kw">*</span>(<span class="dv">3</span><span class="kw">*</span>dca(n)<span class="kw">*</span>phalf(n)<span class="kw">+</span>dca(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span><span class="co">phalf(n-1))/phalf(n))*ca(n)+dt*Rca(n)</span></span>
<span id="cb6-691"><a href="#cb6-691" aria-hidden="true" tabindex="-1"></a>            Byco(n)<span class="kw">=</span>(<span class="dv">2</span><span class="kw">*</span>a<span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n)<span class="kw">+</span>b<span class="kw">*</span>(dco(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>phalf(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span><span class="dv">3</span><span class="kw">*</span>dco(<span class="co">n)*phalf(n))/phalf(n))*co(n-1) &amp;</span></span>
<span id="cb6-692"><a href="#cb6-692" aria-hidden="true" tabindex="-1"></a> <span class="kw">&amp;</span>             <span class="kw">+</span>(<span class="fl">1.</span><span class="kw">-</span>a<span class="kw">*</span><span class="dv">2</span><span class="kw">*</span>whalf(n)<span class="kw">*</span>sigco(n)<span class="kw">-</span>b<span class="kw">*</span>(<span class="dv">3</span><span class="kw">*</span>dco(n)<span class="kw">*</span>phalf(n)<span class="kw">+</span>dco(n<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span><span class="co">phalf(n-1))/phalf(n))*co(n)+dt*Rco(n)</span></span>
<span id="cb6-693"><a href="#cb6-693" aria-hidden="true" tabindex="-1"></a>         <span class="kw">endif</span></span>
<span id="cb6-694"><a href="#cb6-694" aria-hidden="true" tabindex="-1"></a>         <span class="kw">return</span></span>
<span id="cb6-695"><a href="#cb6-695" aria-hidden="true" tabindex="-1"></a>          <span class="kw">end</span></span>
<span id="cb6-696"><a href="#cb6-696" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-697"><a href="#cb6-697" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-698"><a href="#cb6-698" aria-hidden="true" tabindex="-1"></a>        <span class="kw">subroutine</span> tridag(t,m,a,b,c,r,sol)</span>
<span id="cb6-699"><a href="#cb6-699" aria-hidden="true" tabindex="-1"></a><span class="co">! Find the inverse of the tridiagonal matrix A by Thomas algorithm</span></span>
<span id="cb6-700"><a href="#cb6-700" aria-hidden="true" tabindex="-1"></a>          <span class="kw">implicit</span> <span class="kw">none</span></span>
<span id="cb6-701"><a href="#cb6-701" aria-hidden="true" tabindex="-1"></a>          <span class="dt">real*8</span> a(<span class="dv">0</span>:<span class="dv">1000</span>),b(<span class="dv">0</span>:<span class="dv">1000</span>),c(<span class="dv">0</span>:<span class="dv">1000</span>),r(<span class="dv">0</span>:<span class="dv">1000</span>),sol(<span class="dv">0</span>:<span class="dv">1000</span>)</span>
<span id="cb6-702"><a href="#cb6-702" aria-hidden="true" tabindex="-1"></a>          <span class="dt">real*8</span> h(<span class="dv">0</span>:<span class="dv">1000</span>),g(<span class="dv">0</span>:<span class="dv">1000</span>),denom,t</span>
<span id="cb6-703"><a href="#cb6-703" aria-hidden="true" tabindex="-1"></a>          <span class="dt">INTEGER</span> m,i</span>
<span id="cb6-704"><a href="#cb6-704" aria-hidden="true" tabindex="-1"></a>          g(m<span class="kw">-</span><span class="dv">1</span>)<span class="kw">=-</span>a(m)<span class="kw">/</span>b(m)</span>
<span id="cb6-705"><a href="#cb6-705" aria-hidden="true" tabindex="-1"></a>          h(m<span class="kw">-</span><span class="dv">1</span>)<span class="kw">=</span>r(m)<span class="kw">/</span>b(m)</span>
<span id="cb6-706"><a href="#cb6-706" aria-hidden="true" tabindex="-1"></a>          <span class="kw">do</span> <span class="dv">10</span> i<span class="kw">=</span>m<span class="kw">-</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">-</span><span class="dv">1</span></span>
<span id="cb6-707"><a href="#cb6-707" aria-hidden="true" tabindex="-1"></a>             denom<span class="kw">=</span>b(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">+</span>c(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>g(i<span class="kw">+</span><span class="dv">1</span>)</span>
<span id="cb6-708"><a href="#cb6-708" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">if</span> (<span class="bu">dabs</span>(denom)<span class="op">.le.</span><span class="fl">1.d-70</span>) <span class="kw">then</span></span>
<span id="cb6-709"><a href="#cb6-709" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">write (</span><span class="dv">6</span>,<span class="fu">*)</span>  <span class="st">&#39;tridag a echoue a i et t=&#39;</span>,i,t</span>
<span id="cb6-710"><a href="#cb6-710" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">WRITE(</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;denom,b,c,g=&#39;</span>,denom,b(i<span class="kw">+</span><span class="dv">2</span>),c(i<span class="kw">+</span><span class="dv">2</span>),g(i<span class="kw">+</span><span class="dv">2</span>)<span class="co">,b(i+1),c(i+1),g(i+1)</span></span>
<span id="cb6-711"><a href="#cb6-711" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">pause</span></span>
<span id="cb6-712"><a href="#cb6-712" aria-hidden="true" tabindex="-1"></a>                 <span class="kw">endif</span>        </span>
<span id="cb6-713"><a href="#cb6-713" aria-hidden="true" tabindex="-1"></a>                 g(i)<span class="kw">=-</span>a(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">/</span>denom</span>
<span id="cb6-714"><a href="#cb6-714" aria-hidden="true" tabindex="-1"></a>                 h(i)<span class="kw">=</span>(r(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">-</span>c(i<span class="kw">+</span><span class="dv">1</span>)<span class="kw">*</span>h(i<span class="kw">+</span><span class="dv">1</span>))<span class="kw">/</span>denom</span>
<span id="cb6-715"><a href="#cb6-715" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>     <span class="kw">continue</span></span>
<span id="cb6-716"><a href="#cb6-716" aria-hidden="true" tabindex="-1"></a>        sol(<span class="dv">0</span>)<span class="kw">=</span>(r(<span class="dv">0</span>)<span class="kw">-</span>c(<span class="dv">0</span>)<span class="kw">*</span>h(<span class="dv">0</span>))<span class="kw">/</span>(b(<span class="dv">0</span>)<span class="kw">+</span>c(<span class="dv">0</span>)<span class="kw">*</span>g(<span class="dv">0</span>))</span>
<span id="cb6-717"><a href="#cb6-717" aria-hidden="true" tabindex="-1"></a>          <span class="kw">do</span> <span class="dv">11</span> i<span class="kw">=</span><span class="dv">1</span>,m</span>
<span id="cb6-718"><a href="#cb6-718" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>       sol(i)<span class="kw">=</span>sol(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">*</span>g(i<span class="kw">-</span><span class="dv">1</span>)<span class="kw">+</span>h(i<span class="kw">-</span><span class="dv">1</span>)</span>
<span id="cb6-719"><a href="#cb6-719" aria-hidden="true" tabindex="-1"></a>       <span class="kw">return</span></span>
<span id="cb6-720"><a href="#cb6-720" aria-hidden="true" tabindex="-1"></a>          <span class="kw">end</span></span>
<span id="cb6-721"><a href="#cb6-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-722"><a href="#cb6-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-723"><a href="#cb6-723" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-724"><a href="#cb6-724" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-725"><a href="#cb6-725" aria-hidden="true" tabindex="-1"></a>       <span class="kw">subroutine</span> init</span>
<span id="cb6-726"><a href="#cb6-726" aria-hidden="true" tabindex="-1"></a><span class="co">! This routine defines all parameter values and initial conditions, to be passed in vector P.</span></span>
<span id="cb6-727"><a href="#cb6-727" aria-hidden="true" tabindex="-1"></a>           <span class="kw">implicit</span> <span class="kw">none</span></span>
<span id="cb6-728"><a href="#cb6-728" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real*8</span> pho(<span class="dv">0</span>:<span class="dv">1000</span>),cao(<span class="dv">0</span>:<span class="dv">1000</span>),coo(<span class="dv">0</span>:<span class="dv">1000</span>),ARAo(<span class="dv">0</span>:<span class="dv">1000</span>),CALo(<span class="co">0:1000)</span></span>
<span id="cb6-729"><a href="#cb6-729" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> dt,dx, P(<span class="dv">35</span>),Th,mua,rhoa,rhoc,rhot,rhow,D0ca,D0co3,Ka,<span class="co">Kc,beta,k1,k2,k3,length,xdis</span></span>
<span id="cb6-730"><a href="#cb6-730" aria-hidden="true" tabindex="-1"></a>           <span class="dt">REAL*8</span> m,nn,S,phi0,ca0,co30,ccal0,cara0,a,b,Vscale,rhos0,Xs,Ts,eps,xcem,xcemf</span>
<span id="cb6-731"><a href="#cb6-731" aria-hidden="true" tabindex="-1"></a>           <span class="dt">real*8</span> phi00,ca00,co300,ccal00,cara00,phiinf,cAthy</span>
<span id="cb6-732"><a href="#cb6-732" aria-hidden="true" tabindex="-1"></a><span class="co">!           REAL*8 arg,tgh</span></span>
<span id="cb6-733"><a href="#cb6-733" aria-hidden="true" tabindex="-1"></a>           <span class="dt">integer</span> tmax,N,outt,i,outx</span>
<span id="cb6-734"><a href="#cb6-734" aria-hidden="true" tabindex="-1"></a>           <span class="kw">COMMON/</span>general<span class="kw">/</span> pho,cao,coo, ARAo,CALo,tmax,outx,outt, N</span>
<span id="cb6-735"><a href="#cb6-735" aria-hidden="true" tabindex="-1"></a>           <span class="kw">COMMON/</span>par<span class="kw">/</span>P</span>
<span id="cb6-736"><a href="#cb6-736" aria-hidden="true" tabindex="-1"></a><span class="co">!   DIMENSIONLESS TIMES, tmax=max time index, outx = time index for graphic x output</span></span>
<span id="cb6-737"><a href="#cb6-737" aria-hidden="true" tabindex="-1"></a><span class="co">!   outt= time index for graphic t outputs at four points</span></span>
<span id="cb6-738"><a href="#cb6-738" aria-hidden="true" tabindex="-1"></a><span class="co">!  dt, dx = discrete steps (dimensionless) ; N +1 = total number of nodes;</span></span>
<span id="cb6-739"><a href="#cb6-739" aria-hidden="true" tabindex="-1"></a><span class="co">! N must be a multiple of 4</span></span>
<span id="cb6-740"><a href="#cb6-740" aria-hidden="true" tabindex="-1"></a><span class="co">!  Th = thickness of active dissolution zone (cm); length = system size in cm, xdis=position of the beginning of the active dissolution zone (cm)</span></span>
<span id="cb6-741"><a href="#cb6-741" aria-hidden="true" tabindex="-1"></a><span class="co">! mua in g/mol, densities in g/cm3, diff (in pure water) in cm2/a, Ka, Kc in M2</span></span>
<span id="cb6-742"><a href="#cb6-742" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-743"><a href="#cb6-743" aria-hidden="true" tabindex="-1"></a><span class="co">! beta in cm/a, k1, k2,k3 in 1/a, m, n dimensionless</span></span>
<span id="cb6-744"><a href="#cb6-744" aria-hidden="true" tabindex="-1"></a><span class="co">! S in cm/a, phio,cal0,cara0 dimensionless, ca0, co30 in M, a and b (tangh profile for initial concentrations) in cm</span></span>
<span id="cb6-745"><a href="#cb6-745" aria-hidden="true" tabindex="-1"></a><span class="co">! cAthy Athys constant in cm-1; phiinf=porosity at the bottom of the compressed system</span></span>
<span id="cb6-746"><a href="#cb6-746" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-747"><a href="#cb6-747" aria-hidden="true" tabindex="-1"></a><span class="co">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span>
<span id="cb6-748"><a href="#cb6-748" aria-hidden="true" tabindex="-1"></a><span class="co">!           LAX=0</span></span>
<span id="cb6-749"><a href="#cb6-749" aria-hidden="true" tabindex="-1"></a>           dt<span class="kw">=</span><span class="fl">1.d-3</span></span>
<span id="cb6-750"><a href="#cb6-750" aria-hidden="true" tabindex="-1"></a>           dt<span class="kw">=</span><span class="fl">1.d-6</span></span>
<span id="cb6-751"><a href="#cb6-751" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-752"><a href="#cb6-752" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-753"><a href="#cb6-753" aria-hidden="true" tabindex="-1"></a> <span class="co">!          length=2000.</span></span>
<span id="cb6-754"><a href="#cb6-754" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-755"><a href="#cb6-755" aria-hidden="true" tabindex="-1"></a>           xdis<span class="kw">=</span><span class="fl">50.</span></span>
<span id="cb6-756"><a href="#cb6-756" aria-hidden="true" tabindex="-1"></a>           xcem<span class="kw">=-</span><span class="fl">100.</span></span>
<span id="cb6-757"><a href="#cb6-757" aria-hidden="true" tabindex="-1"></a>           xcemf<span class="kw">=</span><span class="fl">1000.</span></span>
<span id="cb6-758"><a href="#cb6-758" aria-hidden="true" tabindex="-1"></a>           length<span class="kw">=</span><span class="fl">500.</span></span>
<span id="cb6-759"><a href="#cb6-759" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-760"><a href="#cb6-760" aria-hidden="true" tabindex="-1"></a>           Th<span class="kw">=</span><span class="fl">100.</span></span>
<span id="cb6-761"><a href="#cb6-761" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-762"><a href="#cb6-762" aria-hidden="true" tabindex="-1"></a>           eps<span class="kw">=</span><span class="fl">1.d-2</span></span>
<span id="cb6-763"><a href="#cb6-763" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb6-764"><a href="#cb6-764" aria-hidden="true" tabindex="-1"></a>           tmax<span class="kw">=</span><span class="dv">12</span></span>
<span id="cb6-765"><a href="#cb6-765" aria-hidden="true" tabindex="-1"></a>           outt<span class="kw">=</span><span class="dv">1</span></span>
<span id="cb6-766"><a href="#cb6-766" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-767"><a href="#cb6-767" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-768"><a href="#cb6-768" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-769"><a href="#cb6-769" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-770"><a href="#cb6-770" aria-hidden="true" tabindex="-1"></a>           outx<span class="kw">=</span>tmax<span class="kw">/</span><span class="dv">4</span></span>
<span id="cb6-771"><a href="#cb6-771" aria-hidden="true" tabindex="-1"></a>           N<span class="kw">=</span><span class="dv">200</span></span>
<span id="cb6-772"><a href="#cb6-772" aria-hidden="true" tabindex="-1"></a>           mua<span class="kw">=</span><span class="fl">100.09</span></span>
<span id="cb6-773"><a href="#cb6-773" aria-hidden="true" tabindex="-1"></a>           rhoa<span class="kw">=</span><span class="fl">2.95</span></span>
<span id="cb6-774"><a href="#cb6-774" aria-hidden="true" tabindex="-1"></a>           rhoc<span class="kw">=</span><span class="fl">2.71</span></span>
<span id="cb6-775"><a href="#cb6-775" aria-hidden="true" tabindex="-1"></a>           rhot<span class="kw">=</span><span class="fl">2.8</span></span>
<span id="cb6-776"><a href="#cb6-776" aria-hidden="true" tabindex="-1"></a>           rhow<span class="kw">=</span><span class="fl">1.023</span></span>
<span id="cb6-777"><a href="#cb6-777" aria-hidden="true" tabindex="-1"></a>           D0ca<span class="kw">=</span><span class="fl">131.9</span></span>
<span id="cb6-778"><a href="#cb6-778" aria-hidden="true" tabindex="-1"></a>           D0co3<span class="kw">=</span><span class="fl">272.6</span></span>
<span id="cb6-779"><a href="#cb6-779" aria-hidden="true" tabindex="-1"></a>           Ka<span class="kw">=</span><span class="fl">10.</span><span class="kw">**</span>(<span class="kw">-</span><span class="fl">6.19</span>)</span>
<span id="cb6-780"><a href="#cb6-780" aria-hidden="true" tabindex="-1"></a>           Kc<span class="kw">=</span><span class="fl">10.</span><span class="kw">**</span>(<span class="kw">-</span><span class="fl">6.37</span>)</span>
<span id="cb6-781"><a href="#cb6-781" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-782"><a href="#cb6-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-783"><a href="#cb6-783" aria-hidden="true" tabindex="-1"></a>           beta<span class="kw">=</span><span class="fl">0.01</span></span>
<span id="cb6-784"><a href="#cb6-784" aria-hidden="true" tabindex="-1"></a>           k1<span class="kw">=</span><span class="fl">0.0</span></span>
<span id="cb6-785"><a href="#cb6-785" aria-hidden="true" tabindex="-1"></a>           k2<span class="kw">=</span><span class="fl">1.d-2</span></span>
<span id="cb6-786"><a href="#cb6-786" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-787"><a href="#cb6-787" aria-hidden="true" tabindex="-1"></a>           k3<span class="kw">=</span><span class="fl">1.d-3</span></span>
<span id="cb6-788"><a href="#cb6-788" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-789"><a href="#cb6-789" aria-hidden="true" tabindex="-1"></a>           m<span class="kw">=</span><span class="fl">2.48</span></span>
<span id="cb6-790"><a href="#cb6-790" aria-hidden="true" tabindex="-1"></a>           nn<span class="kw">=</span><span class="fl">2.8</span></span>
<span id="cb6-791"><a href="#cb6-791" aria-hidden="true" tabindex="-1"></a> <span class="co">!          m=1.</span></span>
<span id="cb6-792"><a href="#cb6-792" aria-hidden="true" tabindex="-1"></a>  <span class="co">!         nn=1.</span></span>
<span id="cb6-793"><a href="#cb6-793" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-794"><a href="#cb6-794" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-795"><a href="#cb6-795" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-796"><a href="#cb6-796" aria-hidden="true" tabindex="-1"></a>           S<span class="kw">=</span><span class="fl">0.01</span></span>
<span id="cb6-797"><a href="#cb6-797" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-798"><a href="#cb6-798" aria-hidden="true" tabindex="-1"></a>           cAthy<span class="kw">=</span><span class="fl">0.1</span></span>
<span id="cb6-799"><a href="#cb6-799" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-800"><a href="#cb6-800" aria-hidden="true" tabindex="-1"></a><span class="co">!           phiinf=0.05</span></span>
<span id="cb6-801"><a href="#cb6-801" aria-hidden="true" tabindex="-1"></a>           phiinf<span class="kw">=</span><span class="fl">0.3</span></span>
<span id="cb6-802"><a href="#cb6-802" aria-hidden="true" tabindex="-1"></a>           phiinf<span class="kw">=</span>eps</span>
<span id="cb6-803"><a href="#cb6-803" aria-hidden="true" tabindex="-1"></a><span class="co">!  new incoming sediment          </span></span>
<span id="cb6-804"><a href="#cb6-804" aria-hidden="true" tabindex="-1"></a>            phi0<span class="kw">=</span><span class="fl">0.7</span> </span>
<span id="cb6-805"><a href="#cb6-805" aria-hidden="true" tabindex="-1"></a>           ca0<span class="kw">=</span><span class="fl">0.5</span><span class="kw">*</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-806"><a href="#cb6-806" aria-hidden="true" tabindex="-1"></a>           co30<span class="kw">=</span><span class="fl">0.5</span><span class="kw">*</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-807"><a href="#cb6-807" aria-hidden="true" tabindex="-1"></a>           ccal0<span class="kw">=</span><span class="fl">0.3</span></span>
<span id="cb6-808"><a href="#cb6-808" aria-hidden="true" tabindex="-1"></a>           cara0<span class="kw">=</span><span class="fl">0.6</span></span>
<span id="cb6-809"><a href="#cb6-809" aria-hidden="true" tabindex="-1"></a><span class="co">!  old uniform sediment</span></span>
<span id="cb6-810"><a href="#cb6-810" aria-hidden="true" tabindex="-1"></a>           phi00<span class="kw">=</span><span class="fl">0.7</span></span>
<span id="cb6-811"><a href="#cb6-811" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-812"><a href="#cb6-812" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-813"><a href="#cb6-813" aria-hidden="true" tabindex="-1"></a>           ca00<span class="kw">=</span><span class="fl">0.5</span><span class="kw">*</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-814"><a href="#cb6-814" aria-hidden="true" tabindex="-1"></a>           co300<span class="kw">=</span><span class="fl">0.5</span><span class="kw">*</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-815"><a href="#cb6-815" aria-hidden="true" tabindex="-1"></a>           ccal00<span class="kw">=</span><span class="fl">0.3</span></span>
<span id="cb6-816"><a href="#cb6-816" aria-hidden="true" tabindex="-1"></a>           cara00<span class="kw">=</span><span class="fl">0.6</span>           </span>
<span id="cb6-817"><a href="#cb6-817" aria-hidden="true" tabindex="-1"></a>           a<span class="kw">=</span><span class="fl">0.7</span> <span class="kw">*</span>length</span>
<span id="cb6-818"><a href="#cb6-818" aria-hidden="true" tabindex="-1"></a>           b<span class="kw">=</span>length<span class="kw">/</span><span class="fl">10.</span></span>
<span id="cb6-819"><a href="#cb6-819" aria-hidden="true" tabindex="-1"></a><span class="co">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span>
<span id="cb6-820"><a href="#cb6-820" aria-hidden="true" tabindex="-1"></a> <span class="co">!          K0=beta*phi0**3/(1-phi0)**2</span></span>
<span id="cb6-821"><a href="#cb6-821" aria-hidden="true" tabindex="-1"></a> <span class="co">! Scale time with beta</span></span>
<span id="cb6-822"><a href="#cb6-822" aria-hidden="true" tabindex="-1"></a>           Vscale<span class="kw">=</span>beta</span>
<span id="cb6-823"><a href="#cb6-823" aria-hidden="true" tabindex="-1"></a> <span class="co">! Scale time with S   </span></span>
<span id="cb6-824"><a href="#cb6-824" aria-hidden="true" tabindex="-1"></a>           Vscale<span class="kw">=</span>S</span>
<span id="cb6-825"><a href="#cb6-825" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb6-826"><a href="#cb6-826" aria-hidden="true" tabindex="-1"></a>           rhos0<span class="kw">=</span>rhot<span class="kw">/</span>(<span class="dv">1</span><span class="kw">-</span>cara0<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>rhot<span class="kw">/</span>rhoa)<span class="kw">-</span>ccal0<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>rhot<span class="kw">/</span>rhoc))</span>
<span id="cb6-827"><a href="#cb6-827" aria-hidden="true" tabindex="-1"></a>           Xs<span class="kw">=</span>D0ca<span class="kw">/</span>Vscale</span>
<span id="cb6-828"><a href="#cb6-828" aria-hidden="true" tabindex="-1"></a>           Ts<span class="kw">=</span>D0ca<span class="kw">/</span>Vscale<span class="kw">/</span>Vscale</span>
<span id="cb6-829"><a href="#cb6-829" aria-hidden="true" tabindex="-1"></a>           dx<span class="kw">=</span>(length<span class="kw">/</span>Xs)<span class="kw">/</span>N</span>
<span id="cb6-830"><a href="#cb6-830" aria-hidden="true" tabindex="-1"></a><span class="co">!         </span></span>
<span id="cb6-831"><a href="#cb6-831" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">1</span>)<span class="kw">=</span> m</span>
<span id="cb6-832"><a href="#cb6-832" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">2</span>)<span class="kw">=</span> nn</span>
<span id="cb6-833"><a href="#cb6-833" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">3</span>)<span class="kw">=</span> k3<span class="kw">/</span>k2</span>
<span id="cb6-834"><a href="#cb6-834" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">4</span>)<span class="kw">=</span> k1<span class="kw">/</span>k2</span>
<span id="cb6-835"><a href="#cb6-835" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">5</span>)<span class="kw">=</span>cara0<span class="kw">/</span>ccal0</span>
<span id="cb6-836"><a href="#cb6-836" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">6</span>)<span class="kw">=</span> rhos0<span class="kw">*</span>ccal0<span class="kw">/</span>(mua<span class="kw">*</span><span class="bu">dsqrt</span>(Kc))</span>
<span id="cb6-837"><a href="#cb6-837" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">7</span>)<span class="kw">=</span> rhos0<span class="kw">*</span>ccal0<span class="kw">/</span>rhoc</span>
<span id="cb6-838"><a href="#cb6-838" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">8</span>)<span class="kw">=</span>phi0</span>
<span id="cb6-839"><a href="#cb6-839" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">9</span>)<span class="kw">=</span> <span class="fl">1.</span><span class="kw">-</span>rhot<span class="kw">/</span>rhoc</span>
<span id="cb6-840"><a href="#cb6-840" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">10</span>)<span class="kw">=</span> <span class="fl">1.</span><span class="kw">-</span>rhot<span class="kw">/</span>rhoa</span>
<span id="cb6-841"><a href="#cb6-841" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">11</span>)<span class="kw">=</span> rhot<span class="kw">/</span>rhow</span>
<span id="cb6-842"><a href="#cb6-842" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">12</span>)<span class="kw">=</span>rhoc<span class="kw">/</span>rhow</span>
<span id="cb6-843"><a href="#cb6-843" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">13</span>)<span class="kw">=</span>rhos0<span class="kw">/</span>rhow<span class="kw">-</span><span class="fl">1.</span></span>
<span id="cb6-844"><a href="#cb6-844" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">14</span>)<span class="kw">=</span>Th<span class="kw">/</span>Xs</span>
<span id="cb6-845"><a href="#cb6-845" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">15</span>)<span class="kw">=</span>dt</span>
<span id="cb6-846"><a href="#cb6-846" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">16</span>)<span class="kw">=</span>dx</span>
<span id="cb6-847"><a href="#cb6-847" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">17</span>)<span class="kw">=</span><span class="dv">1</span><span class="kw">-</span>cara0<span class="kw">-</span>ccal0</span>
<span id="cb6-848"><a href="#cb6-848" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">18</span>)<span class="kw">=</span>cara0</span>
<span id="cb6-849"><a href="#cb6-849" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">19</span>)<span class="kw">=</span>ccal0</span>
<span id="cb6-850"><a href="#cb6-850" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">20</span>)<span class="kw">=</span>rhos0<span class="kw">/</span>rhow</span>
<span id="cb6-851"><a href="#cb6-851" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">21</span>)<span class="kw">=</span>a<span class="kw">/</span>Xs</span>
<span id="cb6-852"><a href="#cb6-852" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">22</span>)<span class="kw">=</span>xdis<span class="kw">/</span>Xs</span>
<span id="cb6-853"><a href="#cb6-853" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">23</span>)<span class="kw">=</span>S<span class="kw">/</span>Vscale</span>
<span id="cb6-854"><a href="#cb6-854" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">24</span>)<span class="kw">=</span>Kc<span class="kw">/</span>Ka</span>
<span id="cb6-855"><a href="#cb6-855" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">25</span>)<span class="kw">=</span> D0co3<span class="kw">/</span>D0ca</span>
<span id="cb6-856"><a href="#cb6-856" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">26</span>)<span class="kw">=</span>k2<span class="kw">*</span>Ts</span>
<span id="cb6-857"><a href="#cb6-857" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">27</span>)<span class="kw">=</span>rhoc<span class="kw">/</span>rhoa</span>
<span id="cb6-858"><a href="#cb6-858" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">28</span>)<span class="kw">=</span>b<span class="kw">/</span>Xs</span>
<span id="cb6-859"><a href="#cb6-859" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">29</span>)<span class="kw">=</span>eps</span>
<span id="cb6-860"><a href="#cb6-860" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">30</span>)<span class="kw">=</span>xcem<span class="kw">/</span>Xs         </span>
<span id="cb6-861"><a href="#cb6-861" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">31</span>)<span class="kw">=</span>xcemf<span class="kw">/</span>Xs</span>
<span id="cb6-862"><a href="#cb6-862" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">32</span>)<span class="kw">=</span>beta<span class="kw">/</span>Vscale</span>
<span id="cb6-863"><a href="#cb6-863" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">33</span>)<span class="kw">=</span><span class="fl">1.</span><span class="kw">/</span>(cAthy<span class="kw">*</span>Xs)</span>
<span id="cb6-864"><a href="#cb6-864" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">34</span>)<span class="kw">=</span>phiinf</span>
<span id="cb6-865"><a href="#cb6-865" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">35</span>)<span class="kw">=</span>beta<span class="kw">*</span>phi0<span class="kw">**</span><span class="dv">3</span><span class="kw">/</span>((phi0<span class="kw">-</span>phiinf)<span class="kw">*</span>cAthy)<span class="kw">/</span>D0ca</span>
<span id="cb6-866"><a href="#cb6-866" aria-hidden="true" tabindex="-1"></a><span class="co">!  case where all densities are equal to rhos</span></span>
<span id="cb6-867"><a href="#cb6-867" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">7</span>)<span class="kw">=</span>ccal0</span>
<span id="cb6-868"><a href="#cb6-868" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">9</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-869"><a href="#cb6-869" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">10</span>)<span class="kw">=</span><span class="fl">0.</span></span>
<span id="cb6-870"><a href="#cb6-870" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">11</span>)<span class="kw">=</span>rhos0<span class="kw">/</span>rhow</span>
<span id="cb6-871"><a href="#cb6-871" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">12</span>)<span class="kw">=</span>P(<span class="dv">11</span>)</span>
<span id="cb6-872"><a href="#cb6-872" aria-hidden="true" tabindex="-1"></a>           P(<span class="dv">27</span>)<span class="kw">=</span><span class="fl">1.</span>  </span>
<span id="cb6-873"><a href="#cb6-873" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-874"><a href="#cb6-874" aria-hidden="true" tabindex="-1"></a><span class="co">! Initial conditions (dimensionless)</span></span>
<span id="cb6-875"><a href="#cb6-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-876"><a href="#cb6-876" aria-hidden="true" tabindex="-1"></a>           pho(<span class="dv">0</span>)<span class="kw">=</span>phi0</span>
<span id="cb6-877"><a href="#cb6-877" aria-hidden="true" tabindex="-1"></a>           cao(<span class="dv">0</span>)<span class="kw">=</span>ca0<span class="kw">/</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-878"><a href="#cb6-878" aria-hidden="true" tabindex="-1"></a>           coo(<span class="dv">0</span>)<span class="kw">=</span>co30<span class="kw">/</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-879"><a href="#cb6-879" aria-hidden="true" tabindex="-1"></a>           ARAo(<span class="dv">0</span>)<span class="kw">=</span>cara0</span>
<span id="cb6-880"><a href="#cb6-880" aria-hidden="true" tabindex="-1"></a>           CALo(<span class="dv">0</span>)<span class="kw">=</span>ccal0</span>
<span id="cb6-881"><a href="#cb6-881" aria-hidden="true" tabindex="-1"></a>          <span class="kw">do</span> <span class="dv">10</span> i<span class="kw">=</span><span class="dv">1</span>,N</span>
<span id="cb6-882"><a href="#cb6-882" aria-hidden="true" tabindex="-1"></a>           pho(i)<span class="kw">=</span>phi00</span>
<span id="cb6-883"><a href="#cb6-883" aria-hidden="true" tabindex="-1"></a><span class="co">!           arg=(i*dx-P(21))/P(28)</span></span>
<span id="cb6-884"><a href="#cb6-884" aria-hidden="true" tabindex="-1"></a><span class="co">!               IF(arg.ge.0.) tgh=(1-dexp(-2*arg))/(1+dexp(-2*arg))</span></span>
<span id="cb6-885"><a href="#cb6-885" aria-hidden="true" tabindex="-1"></a><span class="co">!               IF(arg.lt.0.) tgh=(dexp(2*arg)-1)/(dexp(2*arg)+1)</span></span>
<span id="cb6-886"><a href="#cb6-886" aria-hidden="true" tabindex="-1"></a><span class="co">!           cao(i)=ca0/dsqrt(Kc)*0.5*(1-tgh)</span></span>
<span id="cb6-887"><a href="#cb6-887" aria-hidden="true" tabindex="-1"></a><span class="co">!           coo(i)=co30/dsqrt(Kc) *0.5*(1-tgh)</span></span>
<span id="cb6-888"><a href="#cb6-888" aria-hidden="true" tabindex="-1"></a>           cao(i)<span class="kw">=</span>ca00<span class="kw">/</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-889"><a href="#cb6-889" aria-hidden="true" tabindex="-1"></a>           coo(i)<span class="kw">=</span>co300<span class="kw">/</span><span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-890"><a href="#cb6-890" aria-hidden="true" tabindex="-1"></a>           ARAo(i)<span class="kw">=</span>cara00</span>
<span id="cb6-891"><a href="#cb6-891" aria-hidden="true" tabindex="-1"></a>           CALo(i)<span class="kw">=</span>ccal00</span>
<span id="cb6-892"><a href="#cb6-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-893"><a href="#cb6-893" aria-hidden="true" tabindex="-1"></a> <span class="dv">10</span>     <span class="kw">continue</span></span>
<span id="cb6-894"><a href="#cb6-894" aria-hidden="true" tabindex="-1"></a><span class="co">!</span></span>
<span id="cb6-895"><a href="#cb6-895" aria-hidden="true" tabindex="-1"></a>           <span class="fu">write (</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;Xs (cm), Ts (a)&#39;</span>, Xs,Ts</span>
<span id="cb6-896"><a href="#cb6-896" aria-hidden="true" tabindex="-1"></a>           <span class="fu">write (</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;dt,dx,dtS/dx =&#39;</span>, dt,dx,P(<span class="dv">15</span>)<span class="kw">*</span>(P(<span class="dv">23</span>)<span class="kw">/</span>P(<span class="dv">16</span>))</span>
<span id="cb6-897"><a href="#cb6-897" aria-hidden="true" tabindex="-1"></a>           <span class="fu">WRITE(</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;dx^2/2d=&#39;</span>, P(<span class="dv">16</span>)<span class="kw">**</span><span class="dv">2</span><span class="kw">/</span>(<span class="dv">2</span><span class="kw">*</span>P(<span class="dv">25</span>))</span>
<span id="cb6-898"><a href="#cb6-898" aria-hidden="true" tabindex="-1"></a>           <span class="kw">IF</span>(P(<span class="dv">15</span>)<span class="kw">*</span>P(<span class="dv">23</span>)<span class="kw">/</span>P(<span class="dv">16</span>)<span class="op">.gt.</span><span class="fl">1.</span><span class="kw">/</span><span class="fl">5.</span>) <span class="kw">then</span></span>
<span id="cb6-899"><a href="#cb6-899" aria-hidden="true" tabindex="-1"></a>              <span class="fu">WRITE(</span><span class="dv">6</span>,<span class="fu">*)</span><span class="st">&#39; problem: possible instability&#39;</span></span>
<span id="cb6-900"><a href="#cb6-900" aria-hidden="true" tabindex="-1"></a>              <span class="kw">pause</span></span>
<span id="cb6-901"><a href="#cb6-901" aria-hidden="true" tabindex="-1"></a>           <span class="kw">endif</span></span>
<span id="cb6-902"><a href="#cb6-902" aria-hidden="true" tabindex="-1"></a>           <span class="fu">write (</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;scale for MA, MC =&#39;</span>,rhos0<span class="kw">*</span>cara0<span class="kw">*</span>(<span class="dv">1</span><span class="kw">-</span>phi0), rhos0<span class="kw">*</span><span class="co">ccal0*(1-phi0)</span></span>
<span id="cb6-903"><a href="#cb6-903" aria-hidden="true" tabindex="-1"></a>           <span class="fu">write (</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;scale for c=&#39;</span>,<span class="bu">dsqrt</span>(Kc)</span>
<span id="cb6-904"><a href="#cb6-904" aria-hidden="true" tabindex="-1"></a>           <span class="fu">write (</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;Damkohler number Da=, scaled sedimentation rate,rhos0/rhow=&#39;</span>,P(<span class="dv">26</span>),P(<span class="dv">23</span>),rhos0<span class="kw">/</span>rhow</span>
<span id="cb6-905"><a href="#cb6-905" aria-hidden="true" tabindex="-1"></a>           <span class="fu">WRITE(</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;scaled length, position of dissolution zone=&#39;</span>, length<span class="kw">/</span>Xs, xdis<span class="kw">/</span>Xs,(xdis<span class="kw">+</span>Th)<span class="kw">/</span>Xs</span>
<span id="cb6-906"><a href="#cb6-906" aria-hidden="true" tabindex="-1"></a>           <span class="fu">WRITE(</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;a/Xs,b/Xs, rhosw-1=&#39;</span>,P(<span class="dv">21</span>),P(<span class="dv">28</span>),P(<span class="dv">13</span>)</span>
<span id="cb6-907"><a href="#cb6-907" aria-hidden="true" tabindex="-1"></a>           <span class="fu">write(</span><span class="dv">6</span>,<span class="fu">*)</span> <span class="st">&#39;1/cXs,Dpor/Dca=&#39;</span>,P(<span class="dv">33</span>),P(<span class="dv">35</span>)</span>
<span id="cb6-908"><a href="#cb6-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-909"><a href="#cb6-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-910"><a href="#cb6-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-911"><a href="#cb6-911" aria-hidden="true" tabindex="-1"></a>           <span class="kw">PAUSE</span></span>
<span id="cb6-912"><a href="#cb6-912" aria-hidden="true" tabindex="-1"></a>       <span class="kw">return</span></span>
<span id="cb6-913"><a href="#cb6-913" aria-hidden="true" tabindex="-1"></a>       <span class="kw">end</span></span></code></pre></div>
</div>
</section>
</section>
        </div>
         <div class="col-3 col-s-3 menu" id="menu-container">
                <div id="menu"><nav id="TOC" role="doc-toc">
                                <ul>
                                <li><a href="#main">Main</a>
                                <ul>
                                <li><a href="#parameters-p35">Parameters <code>P(35)</code></a></li>
                                </ul></li>
                                </ul>
                </nav></div>
        </div> 
</div>
<div class="footer">
</div>
<!-- <script>
function toggle_dark_mode() {
    var app = document.getElementsByTagName("BODY")[0];
    if (localStorage.darkMode == "dark") {
	localStorage.darkMode = "light";
	app.setAttribute("dark-mode", "light");
    } else {
	localStorage.darkMode = "dark";
	app.setAttribute("dark-mode", "dark");
    }
}
</script> -->
</body>
</html>
